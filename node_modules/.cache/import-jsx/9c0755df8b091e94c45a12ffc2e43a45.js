const React = require('react');

const {
  Box,
  Text
} = require('ink');

const prettyDiff = require('../../pretty-diff.js');

const prettySource = require('../../pretty-source.js');

const yaml = require('tap-yaml');

const importJSX = require('@isaacs/import-jsx');

const PassFail = importJSX('./pass-fail.js');
const AssertName = importJSX('./assert-name.js');
const Color = importJSX('../../color.js');

module.exports = ({
  res
}) => {
  const {
    ok,
    id,
    name,
    testName,
    skip,
    todo
  } = res;
  const diag = res.diag || {};
  const diff = prettyDiff(diag && diag.diff);

  if (diff) {
    delete diag.diff;
    delete diag.found;
    delete diag.wanted;
    delete diag.pattern;
    delete diag.compare;
  }

  const source = prettySource(diag);
  if (source) delete diag.source; // pretty-print errors found in t.error() assertions

  const origin = diag && diag.found && diag.origin;
  const originSrc = prettySource(origin);

  if (originSrc) {
    origin.message = diag.found.message;
    delete diag.origin;
    delete diag.found;
    delete origin.source;
  }

  delete diag.didNotWant;
  const filtered = /^filter: (only|\/.*\/)$/.test(res.skip);
  return filtered ? /*#__PURE__*/React.createElement(Text, null) : /*#__PURE__*/React.createElement(Box, {
    flexDirection: "column"
  }, /*#__PURE__*/React.createElement(PassFail, {
    ok: ok,
    name: testName,
    skip: skip,
    todo: todo
  }), /*#__PURE__*/React.createElement(AssertName, {
    ok,
    name,
    skip,
    todo
  }), /*#__PURE__*/React.createElement(Text, null, ' '), source ? /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(Text, null, source)) : /*#__PURE__*/React.createElement(Text, null), diff ? /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(Text, null, diff + '\n')) : /*#__PURE__*/React.createElement(Text, null), diag && Object.keys(diag).length ? /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(Text, null, `  ${yaml.stringify({
    test: res.fullname,
    ...diag
  }).split('\n').join('\n  ')}`)) : /*#__PURE__*/React.createElement(Text, null), originSrc ? /*#__PURE__*/React.createElement(Box, {
    flexDirection: "column"
  }, /*#__PURE__*/React.createElement(Box, {
    marginLeft: 2
  }, /*#__PURE__*/React.createElement(Text, null, "Error Origin:", '\n')), /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(Text, null, originSrc)), /*#__PURE__*/React.createElement(Box, {
    marginLeft: 2
  }, /*#__PURE__*/React.createElement(Text, null, yaml.stringify(origin)))) : /*#__PURE__*/React.createElement(Text, null));
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QtcG9pbnQuanMiXSwibmFtZXMiOlsiUmVhY3QiLCJyZXF1aXJlIiwiQm94IiwiVGV4dCIsInByZXR0eURpZmYiLCJwcmV0dHlTb3VyY2UiLCJ5YW1sIiwiaW1wb3J0SlNYIiwiUGFzc0ZhaWwiLCJBc3NlcnROYW1lIiwiQ29sb3IiLCJtb2R1bGUiLCJleHBvcnRzIiwicmVzIiwib2siLCJpZCIsIm5hbWUiLCJ0ZXN0TmFtZSIsInNraXAiLCJ0b2RvIiwiZGlhZyIsImRpZmYiLCJmb3VuZCIsIndhbnRlZCIsInBhdHRlcm4iLCJjb21wYXJlIiwic291cmNlIiwib3JpZ2luIiwib3JpZ2luU3JjIiwibWVzc2FnZSIsImRpZE5vdFdhbnQiLCJmaWx0ZXJlZCIsInRlc3QiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwic3RyaW5naWZ5IiwiZnVsbG5hbWUiLCJzcGxpdCIsImpvaW4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLEtBQUssR0FBR0MsT0FBTyxDQUFDLE9BQUQsQ0FBckI7O0FBQ0EsTUFBTTtBQUFDQyxFQUFBQSxHQUFEO0FBQU1DLEVBQUFBO0FBQU4sSUFBY0YsT0FBTyxDQUFDLEtBQUQsQ0FBM0I7O0FBQ0EsTUFBTUcsVUFBVSxHQUFHSCxPQUFPLENBQUMsc0JBQUQsQ0FBMUI7O0FBQ0EsTUFBTUksWUFBWSxHQUFHSixPQUFPLENBQUMsd0JBQUQsQ0FBNUI7O0FBQ0EsTUFBTUssSUFBSSxHQUFHTCxPQUFPLENBQUMsVUFBRCxDQUFwQjs7QUFDQSxNQUFNTSxTQUFTLEdBQUdOLE9BQU8sQ0FBQyxvQkFBRCxDQUF6Qjs7QUFDQSxNQUFNTyxRQUFRLEdBQUdELFNBQVMsQ0FBQyxnQkFBRCxDQUExQjtBQUNBLE1BQU1FLFVBQVUsR0FBR0YsU0FBUyxDQUFDLGtCQUFELENBQTVCO0FBQ0EsTUFBTUcsS0FBSyxHQUFHSCxTQUFTLENBQUMsZ0JBQUQsQ0FBdkI7O0FBRUFJLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQixDQUFDO0FBQUNDLEVBQUFBO0FB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VSxFQUFFO0FBQWpCLGtCQUFvQixvQkFBQyxJQUFELHlCQUFvQixJQUFwQixDQUFwQixDQURGLGVBRUUsb0JBQUMsR0FBRCxxQkFBSyxvQkFBQyxJQUFELFFBQU9BLFNBQVAsQ0FBTCxDQUZGLGVBR0Usb0JBQUMsR0FBRDtBQUFLLElBQUEsVUFBVSxFQUFFO0FBQWpCLGtCQUFvQixvQkFBQyxJQUFELFFBQU90QixJQUFJLENBQUM4QixTQUFMLENBQWVULE1BQWYsQ0FBUCxDQUFwQixDQUhGLENBRFMsZ0JBTVAsb0JBQUMsSUFBRCxPQXRCTixDQURGO0FBMEJELENBdkREIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpXG5jb25zdCB7Qm94LCBUZXh0fSA9IHJlcXVpcmUoJ2luaycpXG5jb25zdCBwcmV0dHlEaWZmID0gcmVxdWlyZSgnLi4vLi4vcHJldHR5LWRpZmYuanMnKVxuY29uc3QgcHJldHR5U291cmNlID0gcmVxdWlyZSgnLi4vLi4vcHJldHR5LXNvdXJjZS5qcycpXG5jb25zdCB5YW1sID0gcmVxdWlyZSgndGFwLXlhbWwnKVxuY29uc3QgaW1wb3J0SlNYID0gcmVxdWlyZSgnQGlzYWFjcy9pbXBvcnQtanN4JylcbmNvbnN0IFBhc3NGYWlsID0gaW1wb3J0SlNYKCcuL3Bhc3MtZmFpbC5qcycpXG5jb25zdCBBc3NlcnROYW1lID0gaW1wb3J0SlNYKCcuL2Fzc2VydC1uYW1lLmpzJylcbmNvbnN0IENvbG9yID0gaW1wb3J0SlNYKCcuLi8uLi9jb2xvci5qcycpXG5cbm1vZHVsZS5leHBvcnRzID0gKHtyZXN9KSA9PiB7XG4gIGNvbnN0IHtvaywgaWQsIG5hbWUsIHRlc3ROYW1lLCBza2lwLCB0b2RvfSA9IHJlc1xuICBjb25zdCBkaWFnID0gcmVzLmRpYWcgfHwge31cbiAgY29uc3QgZGlmZiA9IHByZXR0eURpZmYoZGlhZyAmJiBkaWFnLmRpZmYpXG4gIGlmIChkaWZmKSB7XG4gICAgZGVsZXRlIGRpYWcuZGlmZlxuICAgIGRlbGV0ZSBkaWFnLmZvdW5kXG4gICAgZGVsZXRlIGRpYWcud2FudGVkXG4gICAgZGVsZXRlIGRpYWcucGF0dGVyblxuICAgIGRlbGV0ZSBkaWFnLmNvbXBhcmVcbiAgfVxuICBjb25zdCBzb3VyY2UgPSBwcmV0dHlTb3VyY2UoZGlhZylcbiAgaWYgKHNvdXJjZSlcbiAgICBkZWxldGUgZGlhZy5zb3VyY2VcblxuICAvLyBwcmV0dHktcHJpbnQgZXJyb3JzIGZvdW5kIGluIHQuZXJyb3IoKSBhc3NlcnRpb25zXG4gIGNvbnN0IG9yaWdpbiA9IGRpYWcgJiYgZGlhZy5mb3VuZCAmJiBkaWFnLm9yaWdpblxuICBjb25zdCBvcmlnaW5TcmMgPSBwcmV0dHlTb3VyY2Uob3JpZ2luKVxuICBpZiAob3JpZ2luU3JjKSB7XG4gICAgb3JpZ2luLm1lc3NhZ2UgPSBkaWFnLmZvdW5kLm1lc3NhZ2VcbiAgICBkZWxldGUgZGlhZy5vcmlnaW5cbiAgICBkZWxldGUgZGlhZy5mb3VuZFxuICAgIGRlbGV0ZSBvcmlnaW4uc291cmNlXG4gIH1cblxuICBkZWxldGUgZGlhZy5kaWROb3RXYW50XG5cbiAgY29uc3QgZmlsdGVyZWQgPSAvXmZpbHRlcjogKG9ubHl8XFwvLipcXC8pJC8udGVzdChyZXMuc2tpcClcblxuICByZXR1cm4gZmlsdGVyZWQgPyA8VGV4dD48L1RleHQ+IDogKFxuICAgIDxCb3ggZmxleERpcmVjdGlvbj1cImNvbHVtblwiPlxuICAgICAgPFBhc3NGYWlsIG9rPXtva30gbmFtZT17dGVzdE5hbWV9IHNraXA9e3NraXB9IHRvZG89e3RvZG99IC8+XG4gICAgICA8QXNzZXJ0TmFtZSB7Li4ue29rLCBuYW1lLCBza2lwLCB0b2RvfX0gLz5cbiAgICAgIDxUZXh0PnsnICd9PC9UZXh0PlxuICAgICAgeyBzb3VyY2UgPyAoPEJveD48VGV4dD57c291cmNlfTwvVGV4dD48L0JveD4pIDogPFRleHQ+PC9UZXh0PiB9XG4gICAgICB7IGRpZmYgPyAoPEJveD48VGV4dD57IGRpZmYgKyAnXFxuJ308L1RleHQ+PC9Cb3g+KSA6IDxUZXh0PjwvVGV4dD4gfVxuICAgICAgeyBkaWFnICYmIE9iamVjdC5rZXlzKGRpYWcpLmxlbmd0aCA/IChcbiAgICAgICAgPEJveD48VGV4dD5cbiAgICAgICAgICB7YCAgJHtcbiAgICAgICAgICAgIHlhbWwuc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgdGVzdDogcmVzLmZ1bGxuYW1lLFxuICAgICAgICAgICAgICAuLi5kaWFnLFxuICAgICAgICAgICAgfSkuc3BsaXQoJ1xcbicpLmpvaW4oJ1xcbiAgJylcbiAgICAgICAgICB9YH1cbiAgICAgICAgPC9UZXh0PjwvQm94PlxuICAgICAgKSA6IDxUZXh0PjwvVGV4dD4gfVxuICAgICAgeyBvcmlnaW5TcmMgPyAoXG4gICAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cImNvbHVtblwiPlxuICAgICAgICAgIDxCb3ggbWFyZ2luTGVmdD17Mn0+PFRleHQ+RXJyb3IgT3JpZ2luOnsnXFxuJ308L1RleHQ+PC9Cb3g+XG4gICAgICAgICAgPEJveD48VGV4dD57b3JpZ2luU3JjfTwvVGV4dD48L0JveD5cbiAgICAgICAgICA8Qm94IG1hcmdpbkxlZnQ9ezJ9PjxUZXh0Pnt5YW1sLnN0cmluZ2lmeShvcmlnaW4pfTwvVGV4dD48L0JveD5cbiAgICAgICAgPC9Cb3g+XG4gICAgICApIDogPFRleHQ+PC9UZXh0PiB9XG4gICAgPC9Cb3g+XG4gIClcbn1cbiJdfQ==