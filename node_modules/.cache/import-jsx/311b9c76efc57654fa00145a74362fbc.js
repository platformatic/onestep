const React = require('react');

const {
  Box,
  Text
} = require('ink');

const util = require('util');

const counts = require('./counts.js');

const chalk = require('chalk');

const yaml = require('tap-yaml');

const ms = require('ms');

const importJSX = require('@isaacs/import-jsx');

const Color = importJSX('../../color.js');
const AssertName = importJSX('./assert-name.js');
const StatusMark = importJSX('./status-mark.js');

const showYaml = test => test.results && !test.results.ok && !test.lists.fail.length && (test.options.exitCode || test.options.signal);

const lists = test => /*#__PURE__*/React.createElement(Box, {
  flexDirection: "column",
  marginBottom: showYaml(test) || test.lists.fail.length || test.lists.todo.length || test.lists.skip.length ? 1 : 0
}, test.lists.fail.length ? /*#__PURE__*/React.createElement(Box, {
  flexDirection: "column"
}, test.lists.fail.map((res, i) => /*#__PURE__*/React.createElement(AssertName, Object.assign({}, res, {
  key: '' + i
})))) : /*#__PURE__*/React.createElement(Text, null), test.lists.todo.length ? /*#__PURE__*/React.createElement(Box, {
  flexDirection: "column"
}, test.lists.todo.map((res, i) => /*#__PURE__*/React.createElement(AssertName, Object.assign({}, res, {
  key: '' + i
})))) : /*#__PURE__*/React.createElement(Text, null), test.lists.skip.length ? /*#__PURE__*/React.createElement(Box, {
  flexDirection: "column"
}, test.lists.skip.map((res, i) => /*#__PURE__*/React.createElement(AssertName, Object.assign({}, res, {
  key: '' + i
})))) : /*#__PURE__*/React.createElement(Text, null), // cases where no tests fail, but the test fails
// eg, exiting with non-zero code, being killed, etc.
showYaml(test) ? /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(Text, null, '  ' + yaml.stringify({
  command: test.options.command,
  args: test.options.args,
  exitCode: test.options.exitCode,
  signal: test.options.signal
}).replace(/\n/g, '\n  ').trimRight())) : /*#__PURE__*/React.createElement(Text, null), printBail(test.results));

const skipOrTodoReason = test => test.options.skip && test.options.skip !== true ? ` > ${chalk.cyan(test.options.skip)}` : test.options.todo && test.options.todo !== true ? ` > ${chalk.magenta(test.options.todo)}` : '';

const printBail = results => !results || !results.bailout ? /*#__PURE__*/React.createElement(Text, null) : /*#__PURE__*/React.createElement(Box, {
  marginTop: 1
}, /*#__PURE__*/React.createElement(Text, null, chalk.bold.red('BAILOUT ') + results.bailout));

const printLists = test => test.results && (test.results.bailout || !test.results.ok || test.counts.pass !== test.counts.total);

const time = (time, start, end) => !start ? /*#__PURE__*/React.createElement(Color, {
  dim: true
}, /*#__PURE__*/React.createElement(Text, null, ' ...')) : /*#__PURE__*/React.createElement(Color, {
  hex: "#aaa",
  bold: true
}, /*#__PURE__*/React.createElement(Text, null, ms(time || (end || Date.now()) - start)));

module.exports = ({
  test
}) => /*#__PURE__*/React.createElement(Box, {
  flexDirection: "column"
}, /*#__PURE__*/React.createElement(Box, null, /*#__PURE__*/React.createElement(StatusMark, {
  test: test
}), /*#__PURE__*/React.createElement(Text, null, ' ' + test.name + skipOrTodoReason(test)), /*#__PURE__*/React.createElement(Text, null, counts(test.counts)), time(test.time, test.startTime, test.endTime)), printLists(test) ? lists(test) : /*#__PURE__*/React.createElement(Text, null));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QuanMiXSwibmFtZXMiOlsiUmVhY3QiLCJyZXF1aXJlIiwiQm94IiwiVGV4dCIsInV0aWwiLCJjb3VudHMiLCJjaGFsayIsInlhbWwiLCJtcyIsImltcG9ydEpTWCIsIkNvbG9yIiwiQXNzZXJ0TmFtZSIsIlN0YXR1c01hcmsiLCJzaG93WWFtbCIsInRlc3QiLCJyZXN1bHRzIiwib2siLCJsaXN0cyIsImZhaWwiLCJsZW5ndGgiLCJvcHRpb25zIiwiZXhpdENvZGUiLCJzaWduYWwiLCJ0b2RvIiwic2tpcCIsIm1hcCIsInJlcyIsImkiLCJzdHJpbmdpZnkiLCJjb21tYW5kIiwiYXJncyIsInJlcGxhY2UiLCJ0cmltUmlnaHQiLCJwcmludEJhaWwiLCJza2lwT3JUb2RvUmVhc29uIiwiY3lhbiIsIm1hZ2VudGEiLCJiYWlsb3V0IiwiYm9sZCIsInJlZCIsInByaW50TGlzdHMiLCJwYXNzIiwidG90YWwiLCJ0aW1lIiwic3RhcnQiLCJlbmQiLCJEYXRlIiwibm93IiwibW9kdWxlIiwiZXhwb3J0cyIsIm5hbWUiLCJzdGFydFRpbWUiLCJlbmRUaW1lIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxLQUFLLEdBQUdDLE9BQU8sQ0FBQyxPQUFELENBQXJCOztBQUNBLE1BQU07QUFBQ0MsRUFBQUEsR0FBRDtBQUFNQyxFQUFBQTtBQUFOLElBQWNGLE9BQU8sQ0FBQyxLQUFELENBQTNCOztBQUNBLE1BQU1HLElBQUksR0FBR0gsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBQ0EsTUFBTUksTUFBTSxHQUFHSixPQUFPLENBQUMsYUFBRCxDQUF0Qjs7QUFDQSxNQUFNSyxLQUFLLEdBQUdMLE9BQU8sQ0FBQyxPQUFELENBQXJCOztBQUNBLE1BQU1NLElBQUksR0FBR04sT0FBTyxDQUFDLFVBQUQsQ0FBcEI7O0FBQ0EsTUFBTU8sRUFBRSxHQUFHUCxPQUFPLENBQUMsSUFBRCxDQUFsQjs7QUFFQSxNQUFNUSxTQUFTLEdBQUdSLE9BQU8sQ0FBQyxvQkFBRCxDQUF6Qjs7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T0MsS0FBUCxFQUFjQyxHQUFkLEtBQ1gsQ0FBQ0QsS0FBRCxnQkFBVSxvQkFBQyxLQUFEO0FBQU8sRUFBQSxHQUFHO0FBQVYsZ0JBQVcsb0JBQUMsSUFBRCxRQUFPLE1BQVAsQ0FBWCxDQUFWLGdCQUNHLG9CQUFDLEtBQUQ7QUFBTyxFQUFBLEdBQUcsRUFBQyxNQUFYO0FBQWtCLEVBQUEsSUFBSTtBQUF0QixnQkFBdUIsb0JBQUMsSUFBRCxRQUN4QnBDLEVBQUUsQ0FBQ21DLElBQUksSUFBSSxDQUFDRSxHQUFHLElBQUlDLElBQUksQ0FBQ0MsR0FBTCxFQUFSLElBQXNCSCxLQUEvQixDQURzQixDQUF2QixDQUZMOztBQUtBSSxNQUFNLENBQUNDLE9BQVAsR0FBaUIsQ0FBQztBQUFDbkMsRUFBQUE7QUFBRCxDQUFELGtCQUNmLG9CQUFDLEdBQUQ7QUFBSyxFQUFBLGFBQWEsRUFBQztBQUFuQixnQkFDRSxvQkFBQyxHQUFELHFCQUNFLG9CQUFDLFVBQUQ7QUFBWSxFQUFBLElBQUksRUFBRUE7QUFBbEIsRUFERixlQUVFLG9CQUFDLElBQUQsUUFBTyxNQUFNQSxJQUFJLENBQUNvQyxJQUFYLEdBQWtCaEIsZ0JBQWdCLENBQUNwQixJQUFELENBQXpDLENBRkYsZUFHRSxvQkFBQyxJQUFELFFBQU9ULE1BQU0sQ0FBQ1MsSUFBSSxDQUFDVCxNQUFOLENBQWIsQ0FIRixFQUlHc0MsSUFBSSxDQUFDN0IsSUFBSSxDQUFDNkIsSUFBTixFQUFZN0IsSUFBSSxDQUFDcUMsU0FBakIsRUFBNEJyQyxJQUFJLENBQUNzQyxPQUFqQyxDQUpQLENBREYsRUFPSVosVUFBVSxDQUFDMUIsSUFBRCxDQUFWLEdBQW1CRyxLQUFLLENBQUNILElBQUQsQ0FBeEIsZ0JBQWlDLG9CQUFDLElBQUQsT0FQckMsQ0FERiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKVxuY29uc3Qge0JveCwgVGV4dH0gPSByZXF1aXJlKCdpbmsnKVxuY29uc3QgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKVxuY29uc3QgY291bnRzID0gcmVxdWlyZSgnLi9jb3VudHMuanMnKVxuY29uc3QgY2hhbGsgPSByZXF1aXJlKCdjaGFsaycpXG5jb25zdCB5YW1sID0gcmVxdWlyZSgndGFwLXlhbWwnKVxuY29uc3QgbXMgPSByZXF1aXJlKCdtcycpXG5cbmNvbnN0IGltcG9ydEpTWCA9IHJlcXVpcmUoJ0Bpc2FhY3MvaW1wb3J0LWpzeCcpXG5jb25zdCBDb2xvciA9IGltcG9ydEpTWCgnLi4vLi4vY29sb3IuanMnKVxuY29uc3QgQXNzZXJ0TmFtZSA9IGltcG9ydEpTWCgnLi9hc3NlcnQtbmFtZS5qcycpXG5jb25zdCBTdGF0dXNNYXJrID0gaW1wb3J0SlNYKCcuL3N0YXR1cy1tYXJrLmpzJylcblxuY29uc3Qgc2hvd1lhbWwgPSB0ZXN0ID0+XG4gIHRlc3QucmVzdWx0cyAmJiAhdGVzdC5yZXN1bHRzLm9rICYmICF0ZXN0Lmxpc3RzLmZhaWwubGVuZ3RoICYmXG4gICh0ZXN0Lm9wdGlvbnMuZXhpdENvZGUgfHwgdGVzdC5vcHRpb25zLnNpZ25hbClcblxuY29uc3QgbGlzdHMgPSB0ZXN0ID0+IChcbiAgPEJveCBmbGV4RGlyZWN0aW9uPVwiY29sdW1uXCIgbWFyZ2luQm90dG9tPXtcbiAgICBzaG93WWFtbCh0ZXN0KSB8fFxuICAgIHRlc3QubGlzdHMuZmFpbC5sZW5ndGggfHxcbiAgICB0ZXN0Lmxpc3RzLnRvZG8ubGVuZ3RoIHx8XG4gICAgdGVzdC5saXN0cy5za2lwLmxlbmd0aCA/IDEgOiAwIH0+XG4gICAgeyB0ZXN0Lmxpc3RzLmZhaWwubGVuZ3RoID8gKFxuICAgICAgPEJveCBmbGV4RGlyZWN0aW9uPVwiY29sdW1uXCI+XG4gICAgICAgIHsgdGVzdC5saXN0cy5mYWlsLm1hcCgocmVzLCBpKSA9PiAoXG4gICAgICAgICAgPEFzc2VydE5hbWUgey4uLnJlc30ga2V5PXsnJytpfSAvPlxuICAgICAgICApKX1cbiAgICAgIDwvQm94PlxuICAgICkgOiA8VGV4dD48L1RleHQ+fVxuICAgIHsgdGVzdC5saXN0cy50b2RvLmxlbmd0aCA/IChcbiAgICAgIDxCb3ggZmxleERpcmVjdGlvbj1cImNvbHVtblwiPlxuICAgICAgICB7IHRlc3QubGlzdHMudG9kby5tYXAoKHJlcywgaSkgPT4gKFxuICAgICAgICAgIDxBc3NlcnROYW1lIHsuLi5yZXN9IGtleT17JycraX0gLz5cbiAgICAgICAgKSl9XG4gICAgICA8L0JveD5cbiAgICApIDogPFRleHQ+PC9UZXh0Pn1cbiAgICB7IHRlc3QubGlzdHMuc2tpcC5sZW5ndGggPyAoXG4gICAgICA8Qm94IGZsZXhEaXJlY3Rpb249XCJjb2x1bW5cIj5cbiAgICAgICAgeyB0ZXN0Lmxpc3RzLnNraXAubWFwKChyZXMsIGkpID0+IChcbiAgICAgICAgICA8QXNzZXJ0TmFtZSB7Li4ucmVzfSBrZXk9eycnK2l9IC8+XG4gICAgICAgICkpfVxuICAgICAgPC9Cb3g+XG4gICAgKSA6IDxUZXh0PjwvVGV4dD59XG5cbiAgICB7IC8vIGNhc2VzIHdoZXJlIG5vIHRlc3RzIGZhaWwsIGJ1dCB0aGUgdGVzdCBmYWlsc1xuICAgICAgLy8gZWcsIGV4aXRpbmcgd2l0aCBub24temVybyBjb2RlLCBiZWluZyBraWxsZWQsIGV0Yy5cbiAgICAgIHNob3dZYW1sKHRlc3QpID8gKFxuICAgICAgICA8Qm94PjxUZXh0PnsnICAnICsgeWFtbC5zdHJpbmdpZnkoe1xuICAgICAgICAgIGNvbW1hbmQ6IHRlc3Qub3B0aW9ucy5jb21tYW5kLFxuICAgICAgICAgIGFyZ3M6IHRlc3Qub3B0aW9ucy5hcmdzLFxuICAgICAgICAgIGV4aXRDb2RlOiB0ZXN0Lm9wdGlvbnMuZXhpdENvZGUsXG4gICAgICAgICAgc2lnbmFsOiB0ZXN0Lm9wdGlvbnMuc2lnbmFsLFxuICAgICAgICB9KS5yZXBsYWNlKC9cXG4vZywgJ1xcbiAgJykudHJpbVJpZ2h0KCl9PC9UZXh0PjwvQm94PlxuICAgICAgKSA6ICg8VGV4dD48L1RleHQ+KSB9XG5cbiAgICB7cHJpbnRCYWlsKHRlc3QucmVzdWx0cyl9XG4gIDwvQm94PlxuKVxuXG5jb25zdCBza2lwT3JUb2RvUmVhc29uID0gdGVzdCA9PlxuICB0ZXN0Lm9wdGlvbnMuc2tpcCAmJiB0ZXN0Lm9wdGlvbnMuc2tpcCAhPT0gdHJ1ZVxuICA/IGAgPiAke2NoYWxrLmN5YW4odGVzdC5vcHRpb25zLnNraXApfWBcbiAgOiB0ZXN0Lm9wdGlvbnMudG9kbyAmJiB0ZXN0Lm9wdGlvbnMudG9kbyAhPT0gdHJ1ZVxuICA/IGAgPiAke2NoYWxrLm1hZ2VudGEodGVzdC5vcHRpb25zLnRvZG8pfWBcbiAgOiAnJ1xuXG5jb25zdCBwcmludEJhaWwgPSByZXN1bHRzID0+XG4gICFyZXN1bHRzIHx8ICFyZXN1bHRzLmJhaWxvdXQgPyA8VGV4dD48L1RleHQ+XG4gIDogPEJveCBtYXJnaW5Ub3A9ezF9PjxUZXh0PntjaGFsay5ib2xkLnJlZCgnQkFJTE9VVCAnKSArIHJlc3VsdHMuYmFpbG91dH08L1RleHQ+PC9Cb3g+XG5cbmNvbnN0IHByaW50TGlzdHMgPSB0ZXN0ID0+XG4gIHRlc3QucmVzdWx0cyAmJiAoXG4gICAgdGVzdC5yZXN1bHRzLmJhaWxvdXQgfHxcbiAgICAhdGVzdC5yZXN1bHRzLm9rIHx8XG4gICAgdGVzdC5jb3VudHMucGFzcyAhPT0gdGVzdC5jb3VudHMudG90YWxcbiAgKVxuXG5jb25zdCB0aW1lID0gKHRpbWUsIHN0YXJ0LCBlbmQpID0+XG4gICFzdGFydCA/ICg8Q29sb3IgZGltPjxUZXh0PnsnIC4uLid9PC9UZXh0PjwvQ29sb3I+KVxuICA6ICg8Q29sb3IgaGV4PVwiI2FhYVwiIGJvbGQ+PFRleHQ+e1xuICAgIG1zKHRpbWUgfHwgKGVuZCB8fCBEYXRlLm5vdygpKSAtIHN0YXJ0KX08L1RleHQ+PC9Db2xvcj4pXG5cbm1vZHVsZS5leHBvcnRzID0gKHt0ZXN0fSkgPT4gKFxuICA8Qm94IGZsZXhEaXJlY3Rpb249XCJjb2x1bW5cIj5cbiAgICA8Qm94PlxuICAgICAgPFN0YXR1c01hcmsgdGVzdD17dGVzdH0gLz5cbiAgICAgIDxUZXh0PnsnICcgKyB0ZXN0Lm5hbWUgKyBza2lwT3JUb2RvUmVhc29uKHRlc3QpfTwvVGV4dD5cbiAgICAgIDxUZXh0Pntjb3VudHModGVzdC5jb3VudHMpfTwvVGV4dD5cbiAgICAgIHt0aW1lKHRlc3QudGltZSwgdGVzdC5zdGFydFRpbWUsIHRlc3QuZW5kVGltZSl9XG4gICAgPC9Cb3g+XG4gICAgeyBwcmludExpc3RzKHRlc3QpID8gbGlzdHModGVzdCkgOiA8VGV4dD48L1RleHQ+IH1cbiAgPC9Cb3g+XG4pXG4iXX0=