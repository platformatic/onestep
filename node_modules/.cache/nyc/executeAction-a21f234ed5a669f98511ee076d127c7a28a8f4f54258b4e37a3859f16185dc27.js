'use strict';function cov_16rfy9yh9p(){var path="/Users/ivan-tymoshenko/projects/platformatic/onestep/tests/executeAction.js";var hash="974c2019836f207a30a63f608b31bb35b9604f28";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/ivan-tymoshenko/projects/platformatic/onestep/tests/executeAction.js",statementMap:{"0":{start:{line:3,column:19},end:{line:3,column:32}},"1":{start:{line:4,column:17},end:{line:4,column:32}},"2":{start:{line:5,column:28},end:{line:5,column:50}},"3":{start:{line:7,column:58},end:{line:7,column:80}},"4":{start:{line:10,column:26},end:{line:10,column:53}},"5":{start:{line:11,column:26},end:{line:11,column:52}},"6":{start:{line:13,column:21},end:{line:13,column:25}},"7":{start:{line:15,column:2},end:{line:25,column:3}},"8":{start:{line:16,column:23},end:{line:16,column:67}},"9":{start:{line:17,column:4},end:{line:17,column:63}},"10":{start:{line:18,column:27},end:{line:18,column:74}},"11":{start:{line:19,column:4},end:{line:19,column:61}},"12":{start:{line:21,column:4},end:{line:21,column:40}},"13":{start:{line:22,column:4},end:{line:22,column:47}},"14":{start:{line:24,column:4},end:{line:24,column:49}},"15":{start:{line:27,column:2},end:{line:34,column:3}},"16":{start:{line:28,column:26},end:{line:28,column:49}},"17":{start:{line:29,column:4},end:{line:29,column:25}},"18":{start:{line:31,column:4},end:{line:33,column:5}},"19":{start:{line:32,column:6},end:{line:32,column:49}},"20":{start:{line:37,column:0},end:{line:37,column:5}}},fnMap:{"0":{name:"run",decl:{start:{line:9,column:15},end:{line:9,column:18}},loc:{start:{line:9,column:22},end:{line:35,column:1}},line:9}},branchMap:{"0":{loc:{start:{line:11,column:26},end:{line:11,column:52}},type:"binary-expr",locations:[{start:{line:11,column:26},end:{line:11,column:41}},{start:{line:11,column:45},end:{line:11,column:52}}],line:11},"1":{loc:{start:{line:15,column:2},end:{line:25,column:3}},type:"if",locations:[{start:{line:15,column:2},end:{line:25,column:3}},{start:{line:15,column:2},end:{line:25,column:3}}],line:15},"2":{loc:{start:{line:31,column:4},end:{line:33,column:5}},type:"if",locations:[{start:{line:31,column:4},end:{line:33,column:5}},{start:{line:31,column:4},end:{line:33,column:5}}],line:31}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"974c2019836f207a30a63f608b31bb35b9604f28"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_16rfy9yh9p=function(){return actualCoverage;};}return actualCoverage;}cov_16rfy9yh9p();const{tmpdir}=(cov_16rfy9yh9p().s[0]++,require('os'));const{join}=(cov_16rfy9yh9p().s[1]++,require('path'));const{mkdtemp,cp,rm}=(cov_16rfy9yh9p().s[2]++,require('fs/promises'));const{createRepository,setupAction,setEnvVariable}=(cov_16rfy9yh9p().s[3]++,require('./helper.js'));async function run(){cov_16rfy9yh9p().f[0]++;const setupRepository=(cov_16rfy9yh9p().s[4]++,process.argv[2]!=='false');const testProjectName=(cov_16rfy9yh9p().s[5]++,(cov_16rfy9yh9p().b[0][0]++,process.argv[3])||(cov_16rfy9yh9p().b[0][1]++,'basic'));let actionFolder=(cov_16rfy9yh9p().s[6]++,null);cov_16rfy9yh9p().s[7]++;if(setupRepository){cov_16rfy9yh9p().b[1][0]++;const fixtureDir=(cov_16rfy9yh9p().s[8]++,join(__dirname,'fixtures',testProjectName));cov_16rfy9yh9p().s[9]++;actionFolder=await mkdtemp(join(tmpdir(),'action_env_'));const repositoryPath=(cov_16rfy9yh9p().s[10]++,await mkdtemp(join(actionFolder,'repository')));cov_16rfy9yh9p().s[11]++;await cp(fixtureDir,repositoryPath,{recursive:true});cov_16rfy9yh9p().s[12]++;await createRepository(actionFolder);cov_16rfy9yh9p().s[13]++;setupAction({projectDir:repositoryPath});cov_16rfy9yh9p().s[14]++;setEnvVariable('PLT_ENV_VARIABLE3','value3');}else{cov_16rfy9yh9p().b[1][1]++;}cov_16rfy9yh9p().s[15]++;try{const executeAction=(cov_16rfy9yh9p().s[16]++,require('../action.js'));cov_16rfy9yh9p().s[17]++;await executeAction();}finally{cov_16rfy9yh9p().s[18]++;if(actionFolder!==null){cov_16rfy9yh9p().b[2][0]++;cov_16rfy9yh9p().s[19]++;await rm(actionFolder,{recursive:true});}else{cov_16rfy9yh9p().b[2][1]++;}}}cov_16rfy9yh9p().s[20]++;run();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ0bXBkaXIiLCJyZXF1aXJlIiwiam9pbiIsIm1rZHRlbXAiLCJjcCIsInJtIiwiY3JlYXRlUmVwb3NpdG9yeSIsInNldHVwQWN0aW9uIiwic2V0RW52VmFyaWFibGUiLCJydW4iLCJzZXR1cFJlcG9zaXRvcnkiLCJwcm9jZXNzIiwiYXJndiIsInRlc3RQcm9qZWN0TmFtZSIsImFjdGlvbkZvbGRlciIsImZpeHR1cmVEaXIiLCJfX2Rpcm5hbWUiLCJyZXBvc2l0b3J5UGF0aCIsInJlY3Vyc2l2ZSIsInByb2plY3REaXIiLCJleGVjdXRlQWN0aW9uIl0sInNvdXJjZXMiOlsiZXhlY3V0ZUFjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcblxuY29uc3QgeyB0bXBkaXIgfSA9IHJlcXVpcmUoJ29zJylcbmNvbnN0IHsgam9pbiB9ID0gcmVxdWlyZSgncGF0aCcpXG5jb25zdCB7IG1rZHRlbXAsIGNwLCBybSB9ID0gcmVxdWlyZSgnZnMvcHJvbWlzZXMnKVxuXG5jb25zdCB7IGNyZWF0ZVJlcG9zaXRvcnksIHNldHVwQWN0aW9uLCBzZXRFbnZWYXJpYWJsZSB9ID0gcmVxdWlyZSgnLi9oZWxwZXIuanMnKVxuXG5hc3luYyBmdW5jdGlvbiBydW4gKCkge1xuICBjb25zdCBzZXR1cFJlcG9zaXRvcnkgPSBwcm9jZXNzLmFyZ3ZbMl0gIT09ICdmYWxzZSdcbiAgY29uc3QgdGVzdFByb2plY3ROYW1lID0gcHJvY2Vzcy5hcmd2WzNdIHx8ICdiYXNpYydcblxuICBsZXQgYWN0aW9uRm9sZGVyID0gbnVsbFxuXG4gIGlmIChzZXR1cFJlcG9zaXRvcnkpIHtcbiAgICBjb25zdCBmaXh0dXJlRGlyID0gam9pbihfX2Rpcm5hbWUsICdmaXh0dXJlcycsIHRlc3RQcm9qZWN0TmFtZSlcbiAgICBhY3Rpb25Gb2xkZXIgPSBhd2FpdCBta2R0ZW1wKGpvaW4odG1wZGlyKCksICdhY3Rpb25fZW52XycpKVxuICAgIGNvbnN0IHJlcG9zaXRvcnlQYXRoID0gYXdhaXQgbWtkdGVtcChqb2luKGFjdGlvbkZvbGRlciwgJ3JlcG9zaXRvcnknKSlcbiAgICBhd2FpdCBjcChmaXh0dXJlRGlyLCByZXBvc2l0b3J5UGF0aCwgeyByZWN1cnNpdmU6IHRydWUgfSlcblxuICAgIGF3YWl0IGNyZWF0ZVJlcG9zaXRvcnkoYWN0aW9uRm9sZGVyKVxuICAgIHNldHVwQWN0aW9uKHsgcHJvamVjdERpcjogcmVwb3NpdG9yeVBhdGggfSlcblxuICAgIHNldEVudlZhcmlhYmxlKCdQTFRfRU5WX1ZBUklBQkxFMycsICd2YWx1ZTMnKVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBleGVjdXRlQWN0aW9uID0gcmVxdWlyZSgnLi4vYWN0aW9uLmpzJylcbiAgICBhd2FpdCBleGVjdXRlQWN0aW9uKClcbiAgfSBmaW5hbGx5IHtcbiAgICBpZiAoYWN0aW9uRm9sZGVyICE9PSBudWxsKSB7XG4gICAgICBhd2FpdCBybShhY3Rpb25Gb2xkZXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pXG4gICAgfVxuICB9XG59XG5cbnJ1bigpXG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVksd29GQWVBO0FBQUEsMkZBYlosS0FBTSxDQUFFQSxNQUFPLENBQUMsMEJBQUdDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFDaEMsS0FBTSxDQUFFQyxJQUFLLENBQUMsMEJBQUdELE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFDaEMsS0FBTSxDQUFFRSxPQUFPLENBQUVDLEVBQUUsQ0FBRUMsRUFBRyxDQUFDLDBCQUFHSixPQUFPLENBQUMsYUFBYSxDQUFDLEVBRWxELEtBQU0sQ0FBRUssZ0JBQWdCLENBQUVDLFdBQVcsQ0FBRUMsY0FBZSxDQUFDLDBCQUFHUCxPQUFPLENBQUMsYUFBYSxDQUFDLEVBRWhGLGNBQWVRLElBQUcsRUFBSSx5QkFDcEIsS0FBTUMsZ0JBQWUsMEJBQUdDLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFLLE9BQU8sRUFDbkQsS0FBTUMsZ0JBQWUsMEJBQUcsNEJBQUFGLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQywrQkFBSSxPQUFPLEdBRWxELEdBQUlFLGFBQVksMEJBQUcsSUFBSSwwQkFFdkIsR0FBSUosZUFBZSxDQUFFLDRCQUNuQixLQUFNSyxXQUFVLDBCQUFHYixJQUFJLENBQUNjLFNBQVMsQ0FBRSxVQUFVLENBQUVILGVBQWUsQ0FBQywwQkFDL0RDLFlBQVksQ0FBRyxLQUFNWCxRQUFPLENBQUNELElBQUksQ0FBQ0YsTUFBTSxFQUFFLENBQUUsYUFBYSxDQUFDLENBQUMsQ0FDM0QsS0FBTWlCLGVBQWMsMkJBQUcsS0FBTWQsUUFBTyxDQUFDRCxJQUFJLENBQUNZLFlBQVksQ0FBRSxZQUFZLENBQUMsQ0FBQywyQkFDdEUsS0FBTVYsR0FBRSxDQUFDVyxVQUFVLENBQUVFLGNBQWMsQ0FBRSxDQUFFQyxTQUFTLENBQUUsSUFBSyxDQUFDLENBQUMsMEJBRXpELEtBQU1aLGlCQUFnQixDQUFDUSxZQUFZLENBQUMsMEJBQ3BDUCxXQUFXLENBQUMsQ0FBRVksVUFBVSxDQUFFRixjQUFlLENBQUMsQ0FBQywwQkFFM0NULGNBQWMsQ0FBQyxtQkFBbUIsQ0FBRSxRQUFRLENBQUMsQ0FDL0MsQ0FBQywwREFFRCxHQUFJLENBQ0YsS0FBTVksY0FBYSwyQkFBR25CLE9BQU8sQ0FBQyxjQUFjLENBQUMsMkJBQzdDLEtBQU1tQixjQUFhLEVBQUUsQ0FDdkIsQ0FBQyxPQUFTLDBCQUNSLEdBQUlOLFlBQVksR0FBSyxJQUFJLENBQUUscURBQ3pCLEtBQU1ULEdBQUUsQ0FBQ1MsWUFBWSxDQUFFLENBQUVJLFNBQVMsQ0FBRSxJQUFLLENBQUMsQ0FBQyxDQUM3QyxDQUFDLGlDQUNILENBQ0YsQ0FBQyx5QkFFRFQsR0FBRyxFQUFFIn0=