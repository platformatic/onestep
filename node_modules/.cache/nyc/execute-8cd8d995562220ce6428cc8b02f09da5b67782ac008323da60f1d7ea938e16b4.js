'use strict';function cov_m3vzi29jy(){var path="/Users/ivan-tymoshenko/projects/platformatic/onestep/tests/execute.js";var hash="3d448dec160402bdc20a12ec7c0e8dc52ef72caf";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/ivan-tymoshenko/projects/platformatic/onestep/tests/execute.js",statementMap:{"0":{start:{line:3,column:19},end:{line:3,column:32}},"1":{start:{line:4,column:17},end:{line:4,column:32}},"2":{start:{line:5,column:28},end:{line:5,column:50}},"3":{start:{line:12,column:4},end:{line:12,column:26}},"4":{start:{line:14,column:23},end:{line:22,column:1}},"5":{start:{line:25,column:26},end:{line:25,column:53}},"6":{start:{line:26,column:26},end:{line:26,column:52}},"7":{start:{line:27,column:33},end:{line:27,column:48}},"8":{start:{line:33,column:21},end:{line:33,column:25}},"9":{start:{line:35,column:2},end:{line:45,column:3}},"10":{start:{line:36,column:23},end:{line:36,column:67}},"11":{start:{line:37,column:4},end:{line:37,column:63}},"12":{start:{line:38,column:27},end:{line:38,column:74}},"13":{start:{line:39,column:4},end:{line:39,column:61}},"14":{start:{line:41,column:4},end:{line:41,column:40}},"15":{start:{line:42,column:4},end:{line:42,column:47}},"16":{start:{line:44,column:4},end:{line:44,column:49}},"17":{start:{line:47,column:2},end:{line:54,column:3}},"18":{start:{line:48,column:26},end:{line:48,column:49}},"19":{start:{line:49,column:4},end:{line:49,column:25}},"20":{start:{line:51,column:4},end:{line:53,column:5}},"21":{start:{line:52,column:6},end:{line:52,column:49}},"22":{start:{line:57,column:0},end:{line:57,column:5}}},fnMap:{"0":{name:"run",decl:{start:{line:24,column:15},end:{line:24,column:18}},loc:{start:{line:24,column:22},end:{line:55,column:1}},line:24}},branchMap:{"0":{loc:{start:{line:26,column:26},end:{line:26,column:52}},type:"binary-expr",locations:[{start:{line:26,column:26},end:{line:26,column:41}},{start:{line:26,column:45},end:{line:26,column:52}}],line:26},"1":{loc:{start:{line:35,column:2},end:{line:45,column:3}},type:"if",locations:[{start:{line:35,column:2},end:{line:45,column:3}},{start:{line:35,column:2},end:{line:45,column:3}}],line:35},"2":{loc:{start:{line:51,column:4},end:{line:53,column:5}},type:"if",locations:[{start:{line:51,column:4},end:{line:53,column:5}},{start:{line:51,column:4},end:{line:53,column:5}}],line:51}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"3d448dec160402bdc20a12ec7c0e8dc52ef72caf"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_m3vzi29jy=function(){return actualCoverage;};}return actualCoverage;}cov_m3vzi29jy();const{tmpdir}=(cov_m3vzi29jy().s[0]++,require('os'));const{join}=(cov_m3vzi29jy().s[1]++,require('path'));const{mkdtemp,cp,rm}=(cov_m3vzi29jy().s[2]++,require('fs/promises'));const{createRepository,setupAction,setEnvVariable,setInputParam}=(cov_m3vzi29jy().s[3]++,require('./helper.js'));const defaultEnvVars=(cov_m3vzi29jy().s[4]++,{GITHUB_WORKSPACE:'',STEVE_SERVER_URL:'http://localhost:3042',HARRY_SERVER_URL:'http://localhost:3043',INPUT_PLATFORMATIC_API_KEY:'1234',INPUT_GITHUB_TOKEN:'test'});async function run(){cov_m3vzi29jy().f[0]++;const setupRepository=(cov_m3vzi29jy().s[5]++,process.argv[2]!=='false');const testProjectName=(cov_m3vzi29jy().s[6]++,(cov_m3vzi29jy().b[0][0]++,process.argv[3])||(cov_m3vzi29jy().b[0][1]++,'basic'));const platformaticConfigPath=(cov_m3vzi29jy().s[7]++,process.argv[4]);// if (platformaticConfigPath !== undefined) {
//   setInputParam('platformatic_config_path', platformaticConfigPath)
// }
let actionFolder=(cov_m3vzi29jy().s[8]++,null);cov_m3vzi29jy().s[9]++;if(setupRepository){cov_m3vzi29jy().b[1][0]++;const fixtureDir=(cov_m3vzi29jy().s[10]++,join(__dirname,'fixtures',testProjectName));cov_m3vzi29jy().s[11]++;actionFolder=await mkdtemp(join(tmpdir(),'action_env_'));const repositoryPath=(cov_m3vzi29jy().s[12]++,await mkdtemp(join(actionFolder,'repository')));cov_m3vzi29jy().s[13]++;await cp(fixtureDir,repositoryPath,{recursive:true});cov_m3vzi29jy().s[14]++;await createRepository(actionFolder);cov_m3vzi29jy().s[15]++;setupAction({projectDir:repositoryPath});cov_m3vzi29jy().s[16]++;setEnvVariable('PLT_ENV_VARIABLE3','value3');}else{cov_m3vzi29jy().b[1][1]++;}cov_m3vzi29jy().s[17]++;try{const executeAction=(cov_m3vzi29jy().s[18]++,require('../action.js'));cov_m3vzi29jy().s[19]++;await executeAction();}finally{cov_m3vzi29jy().s[20]++;if(actionFolder!==null){cov_m3vzi29jy().b[2][0]++;cov_m3vzi29jy().s[21]++;await rm(actionFolder,{recursive:true});}else{cov_m3vzi29jy().b[2][1]++;}}}cov_m3vzi29jy().s[22]++;run();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ0bXBkaXIiLCJyZXF1aXJlIiwiam9pbiIsIm1rZHRlbXAiLCJjcCIsInJtIiwiY3JlYXRlUmVwb3NpdG9yeSIsInNldHVwQWN0aW9uIiwic2V0RW52VmFyaWFibGUiLCJzZXRJbnB1dFBhcmFtIiwiZGVmYXVsdEVudlZhcnMiLCJHSVRIVUJfV09SS1NQQUNFIiwiU1RFVkVfU0VSVkVSX1VSTCIsIkhBUlJZX1NFUlZFUl9VUkwiLCJJTlBVVF9QTEFURk9STUFUSUNfQVBJX0tFWSIsIklOUFVUX0dJVEhVQl9UT0tFTiIsInJ1biIsInNldHVwUmVwb3NpdG9yeSIsInByb2Nlc3MiLCJhcmd2IiwidGVzdFByb2plY3ROYW1lIiwicGxhdGZvcm1hdGljQ29uZmlnUGF0aCIsImFjdGlvbkZvbGRlciIsImZpeHR1cmVEaXIiLCJfX2Rpcm5hbWUiLCJyZXBvc2l0b3J5UGF0aCIsInJlY3Vyc2l2ZSIsInByb2plY3REaXIiLCJleGVjdXRlQWN0aW9uIl0sInNvdXJjZXMiOlsiZXhlY3V0ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcblxuY29uc3QgeyB0bXBkaXIgfSA9IHJlcXVpcmUoJ29zJylcbmNvbnN0IHsgam9pbiB9ID0gcmVxdWlyZSgncGF0aCcpXG5jb25zdCB7IG1rZHRlbXAsIGNwLCBybSB9ID0gcmVxdWlyZSgnZnMvcHJvbWlzZXMnKVxuXG5jb25zdCB7XG4gIGNyZWF0ZVJlcG9zaXRvcnksXG4gIHNldHVwQWN0aW9uLFxuICBzZXRFbnZWYXJpYWJsZSxcbiAgc2V0SW5wdXRQYXJhbVxufSA9IHJlcXVpcmUoJy4vaGVscGVyLmpzJylcblxuY29uc3QgZGVmYXVsdEVudlZhcnMgPSB7XG4gIEdJVEhVQl9XT1JLU1BBQ0U6ICcnLFxuXG4gIFNURVZFX1NFUlZFUl9VUkw6ICdodHRwOi8vbG9jYWxob3N0OjMwNDInLFxuICBIQVJSWV9TRVJWRVJfVVJMOiAnaHR0cDovL2xvY2FsaG9zdDozMDQzJyxcblxuICBJTlBVVF9QTEFURk9STUFUSUNfQVBJX0tFWTogJzEyMzQnLFxuICBJTlBVVF9HSVRIVUJfVE9LRU46ICd0ZXN0J1xufVxuXG5hc3luYyBmdW5jdGlvbiBydW4gKCkge1xuICBjb25zdCBzZXR1cFJlcG9zaXRvcnkgPSBwcm9jZXNzLmFyZ3ZbMl0gIT09ICdmYWxzZSdcbiAgY29uc3QgdGVzdFByb2plY3ROYW1lID0gcHJvY2Vzcy5hcmd2WzNdIHx8ICdiYXNpYydcbiAgY29uc3QgcGxhdGZvcm1hdGljQ29uZmlnUGF0aCA9IHByb2Nlc3MuYXJndls0XVxuXG4gIC8vIGlmIChwbGF0Zm9ybWF0aWNDb25maWdQYXRoICE9PSB1bmRlZmluZWQpIHtcbiAgLy8gICBzZXRJbnB1dFBhcmFtKCdwbGF0Zm9ybWF0aWNfY29uZmlnX3BhdGgnLCBwbGF0Zm9ybWF0aWNDb25maWdQYXRoKVxuICAvLyB9XG5cbiAgbGV0IGFjdGlvbkZvbGRlciA9IG51bGxcblxuICBpZiAoc2V0dXBSZXBvc2l0b3J5KSB7XG4gICAgY29uc3QgZml4dHVyZURpciA9IGpvaW4oX19kaXJuYW1lLCAnZml4dHVyZXMnLCB0ZXN0UHJvamVjdE5hbWUpXG4gICAgYWN0aW9uRm9sZGVyID0gYXdhaXQgbWtkdGVtcChqb2luKHRtcGRpcigpLCAnYWN0aW9uX2Vudl8nKSlcbiAgICBjb25zdCByZXBvc2l0b3J5UGF0aCA9IGF3YWl0IG1rZHRlbXAoam9pbihhY3Rpb25Gb2xkZXIsICdyZXBvc2l0b3J5JykpXG4gICAgYXdhaXQgY3AoZml4dHVyZURpciwgcmVwb3NpdG9yeVBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pXG5cbiAgICBhd2FpdCBjcmVhdGVSZXBvc2l0b3J5KGFjdGlvbkZvbGRlcilcbiAgICBzZXR1cEFjdGlvbih7IHByb2plY3REaXI6IHJlcG9zaXRvcnlQYXRoIH0pXG5cbiAgICBzZXRFbnZWYXJpYWJsZSgnUExUX0VOVl9WQVJJQUJMRTMnLCAndmFsdWUzJylcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgZXhlY3V0ZUFjdGlvbiA9IHJlcXVpcmUoJy4uL2FjdGlvbi5qcycpXG4gICAgYXdhaXQgZXhlY3V0ZUFjdGlvbigpXG4gIH0gZmluYWxseSB7XG4gICAgaWYgKGFjdGlvbkZvbGRlciAhPT0gbnVsbCkge1xuICAgICAgYXdhaXQgcm0oYWN0aW9uRm9sZGVyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KVxuICAgIH1cbiAgfVxufVxuXG5ydW4oKVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZLCt2RkFlQTtBQUFBLHlGQWJaLEtBQU0sQ0FBRUEsTUFBTyxDQUFDLHlCQUFHQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQ2hDLEtBQU0sQ0FBRUMsSUFBSyxDQUFDLHlCQUFHRCxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQ2hDLEtBQU0sQ0FBRUUsT0FBTyxDQUFFQyxFQUFFLENBQUVDLEVBQUcsQ0FBQyx5QkFBR0osT0FBTyxDQUFDLGFBQWEsQ0FBQyxFQUVsRCxLQUFNLENBQ0pLLGdCQUFnQixDQUNoQkMsV0FBVyxDQUNYQyxjQUFjLENBQ2RDLGFBQ0YsQ0FBQyx5QkFBR1IsT0FBTyxDQUFDLGFBQWEsQ0FBQyxFQUUxQixLQUFNUyxlQUFjLHlCQUFHLENBQ3JCQyxnQkFBZ0IsQ0FBRSxFQUFFLENBRXBCQyxnQkFBZ0IsQ0FBRSx1QkFBdUIsQ0FDekNDLGdCQUFnQixDQUFFLHVCQUF1QixDQUV6Q0MsMEJBQTBCLENBQUUsTUFBTSxDQUNsQ0Msa0JBQWtCLENBQUUsTUFDdEIsQ0FBQyxFQUVELGNBQWVDLElBQUcsRUFBSSx3QkFDcEIsS0FBTUMsZ0JBQWUseUJBQUdDLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFLLE9BQU8sRUFDbkQsS0FBTUMsZ0JBQWUseUJBQUcsMkJBQUFGLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQyw4QkFBSSxPQUFPLEdBQ2xELEtBQU1FLHVCQUFzQix5QkFBR0gsT0FBTyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBRTlDO0FBQ0E7QUFDQTtBQUVBLEdBQUlHLGFBQVkseUJBQUcsSUFBSSx5QkFFdkIsR0FBSUwsZUFBZSxDQUFFLDJCQUNuQixLQUFNTSxXQUFVLDBCQUFHckIsSUFBSSxDQUFDc0IsU0FBUyxDQUFFLFVBQVUsQ0FBRUosZUFBZSxDQUFDLDBCQUMvREUsWUFBWSxDQUFHLEtBQU1uQixRQUFPLENBQUNELElBQUksQ0FBQ0YsTUFBTSxFQUFFLENBQUUsYUFBYSxDQUFDLENBQUMsQ0FDM0QsS0FBTXlCLGVBQWMsMEJBQUcsS0FBTXRCLFFBQU8sQ0FBQ0QsSUFBSSxDQUFDb0IsWUFBWSxDQUFFLFlBQVksQ0FBQyxDQUFDLDBCQUN0RSxLQUFNbEIsR0FBRSxDQUFDbUIsVUFBVSxDQUFFRSxjQUFjLENBQUUsQ0FBRUMsU0FBUyxDQUFFLElBQUssQ0FBQyxDQUFDLHlCQUV6RCxLQUFNcEIsaUJBQWdCLENBQUNnQixZQUFZLENBQUMseUJBQ3BDZixXQUFXLENBQUMsQ0FBRW9CLFVBQVUsQ0FBRUYsY0FBZSxDQUFDLENBQUMseUJBRTNDakIsY0FBYyxDQUFDLG1CQUFtQixDQUFFLFFBQVEsQ0FBQyxDQUMvQyxDQUFDLHdEQUVELEdBQUksQ0FDRixLQUFNb0IsY0FBYSwwQkFBRzNCLE9BQU8sQ0FBQyxjQUFjLENBQUMsMEJBQzdDLEtBQU0yQixjQUFhLEVBQUUsQ0FDdkIsQ0FBQyxPQUFTLHlCQUNSLEdBQUlOLFlBQVksR0FBSyxJQUFJLENBQUUsbURBQ3pCLEtBQU1qQixHQUFFLENBQUNpQixZQUFZLENBQUUsQ0FBRUksU0FBUyxDQUFFLElBQUssQ0FBQyxDQUFDLENBQzdDLENBQUMsZ0NBQ0gsQ0FDRixDQUFDLHdCQUVEVixHQUFHLEVBQUUifQ==