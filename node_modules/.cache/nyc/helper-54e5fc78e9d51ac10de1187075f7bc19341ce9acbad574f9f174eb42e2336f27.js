'use strict';function cov_vwieuvxrz(){var path="/Users/ivan-tymoshenko/projects/platformatic/onestep/tests/helper.js";var hash="4b68827f27839ee07f5caee31dd234ab0a48cb35";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/ivan-tymoshenko/projects/platformatic/onestep/tests/helper.js",statementMap:{"0":{start:{line:3,column:19},end:{line:3,column:32}},"1":{start:{line:4,column:17},end:{line:4,column:32}},"2":{start:{line:5,column:39},end:{line:5,column:61}},"3":{start:{line:7,column:16},end:{line:7,column:34}},"4":{start:{line:8,column:21},end:{line:8,column:48}},"5":{start:{line:11,column:2},end:{line:11,column:26}},"6":{start:{line:15,column:20},end:{line:15,column:48}},"7":{start:{line:16,column:2},end:{line:16,column:29}},"8":{start:{line:20,column:2},end:{line:20,column:51}},"9":{start:{line:22,column:2},end:{line:22,column:56}},"10":{start:{line:23,column:2},end:{line:23,column:56}},"11":{start:{line:25,column:2},end:{line:25,column:47}},"12":{start:{line:26,column:2},end:{line:26,column:39}},"13":{start:{line:30,column:26},end:{line:30,column:70}},"14":{start:{line:31,column:25},end:{line:31,column:75}},"15":{start:{line:32,column:2},end:{line:32,column:59}},"16":{start:{line:34,column:2},end:{line:36,column:4}},"17":{start:{line:35,column:4},end:{line:35,column:50}},"18":{start:{line:38,column:16},end:{line:38,column:25}},"19":{start:{line:39,column:25},end:{line:39,column:38}},"20":{start:{line:41,column:19},end:{line:41,column:20}},"21":{start:{line:42,column:18},end:{line:42,column:24}},"22":{start:{line:44,column:18},end:{line:63,column:3}},"23":{start:{line:65,column:32},end:{line:65,column:74}},"24":{start:{line:66,column:2},end:{line:66,column:65}},"25":{start:{line:67,column:2},end:{line:67,column:55}},"26":{start:{line:69,column:2},end:{line:69,column:61}},"27":{start:{line:71,column:2},end:{line:71,column:23}},"28":{start:{line:75,column:19},end:{line:75,column:33}},"29":{start:{line:77,column:2},end:{line:81,column:37}},"30":{start:{line:83,column:2},end:{line:87,column:37}},"31":{start:{line:89,column:2},end:{line:112,column:4}},"32":{start:{line:116,column:23},end:{line:116,column:55}},"33":{start:{line:118,column:2},end:{line:123,column:4}},"34":{start:{line:119,column:4},end:{line:122,column:5}},"35":{start:{line:125,column:2},end:{line:129,column:4}},"36":{start:{line:126,column:4},end:{line:128,column:5}},"37":{start:{line:131,column:2},end:{line:133,column:4}},"38":{start:{line:132,column:4},end:{line:132,column:30}},"39":{start:{line:134,column:2},end:{line:134,column:43}},"40":{start:{line:135,column:2},end:{line:135,column:21}},"41":{start:{line:139,column:16},end:{line:139,column:48}},"42":{start:{line:141,column:2},end:{line:145,column:3}},"43":{start:{line:144,column:32},end:{line:144,column:38}},"44":{start:{line:147,column:2},end:{line:147,column:52}},"45":{start:{line:149,column:2},end:{line:151,column:4}},"46":{start:{line:150,column:4},end:{line:150,column:23}},"47":{start:{line:152,column:2},end:{line:152,column:36}},"48":{start:{line:153,column:2},end:{line:153,column:14}},"49":{start:{line:157,column:18},end:{line:157,column:50}},"50":{start:{line:159,column:2},end:{line:159,column:48}},"51":{start:{line:161,column:2},end:{line:163,column:4}},"52":{start:{line:162,column:4},end:{line:162,column:25}},"53":{start:{line:164,column:2},end:{line:164,column:38}},"54":{start:{line:165,column:2},end:{line:165,column:16}},"55":{start:{line:168,column:0},end:{line:175,column:1}}},fnMap:{"0":{name:"setEnvVar",decl:{start:{line:10,column:9},end:{line:10,column:18}},loc:{start:{line:10,column:32},end:{line:12,column:1}},line:10},"1":{name:"setInputParam",decl:{start:{line:14,column:9},end:{line:14,column:22}},loc:{start:{line:14,column:36},end:{line:17,column:1}},line:14},"2":{name:"setupAction",decl:{start:{line:19,column:9},end:{line:19,column:20}},loc:{start:{line:19,column:34},end:{line:27,column:1}},line:19},"3":{name:"createRepository",decl:{start:{line:29,column:15},end:{line:29,column:31}},loc:{start:{line:29,column:48},end:{line:72,column:1}},line:29},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:13},end:{line:34,column:14}},loc:{start:{line:34,column:25},end:{line:36,column:3}},line:34},"5":{name:"startGithubApi",decl:{start:{line:74,column:9},end:{line:74,column:23}},loc:{start:{line:74,column:70},end:{line:113,column:1}},line:74},"6":{name:"startControlPanel",decl:{start:{line:115,column:15},end:{line:115,column:32}},loc:{start:{line:115,column:37},end:{line:136,column:1}},line:115},"7":{name:"(anonymous_7)",decl:{start:{line:118,column:32},end:{line:118,column:33}},loc:{start:{line:118,column:58},end:{line:123,column:3}},line:118},"8":{name:"(anonymous_8)",decl:{start:{line:125,column:53},end:{line:125,column:54}},loc:{start:{line:125,column:79},end:{line:129,column:3}},line:125},"9":{name:"(anonymous_9)",decl:{start:{line:131,column:13},end:{line:131,column:14}},loc:{start:{line:131,column:25},end:{line:133,column:3}},line:131},"10":{name:"startHarry",decl:{start:{line:138,column:15},end:{line:138,column:25}},loc:{start:{line:138,column:30},end:{line:154,column:1}},line:138},"11":{name:"(anonymous_11)",decl:{start:{line:144,column:4},end:{line:144,column:5}},loc:{start:{line:144,column:32},end:{line:144,column:38}},line:144},"12":{name:"(anonymous_12)",decl:{start:{line:147,column:23},end:{line:147,column:24}},loc:{start:{line:147,column:49},end:{line:147,column:51}},line:147},"13":{name:"(anonymous_13)",decl:{start:{line:149,column:13},end:{line:149,column:14}},loc:{start:{line:149,column:25},end:{line:151,column:3}},line:149},"14":{name:"startMachine",decl:{start:{line:156,column:15},end:{line:156,column:27}},loc:{start:{line:156,column:32},end:{line:166,column:1}},line:156},"15":{name:"(anonymous_15)",decl:{start:{line:159,column:19},end:{line:159,column:20}},loc:{start:{line:159,column:45},end:{line:159,column:47}},line:159},"16":{name:"(anonymous_16)",decl:{start:{line:161,column:13},end:{line:161,column:14}},loc:{start:{line:161,column:25},end:{line:163,column:3}},line:161}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"4b68827f27839ee07f5caee31dd234ab0a48cb35"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_vwieuvxrz=function(){return actualCoverage;};}return actualCoverage;}cov_vwieuvxrz();const{tmpdir}=(cov_vwieuvxrz().s[0]++,require('os'));const{join}=(cov_vwieuvxrz().s[1]++,require('path'));const{writeFile,mkdtemp,cp,rm}=(cov_vwieuvxrz().s[2]++,require('fs/promises'));const fastify=(cov_vwieuvxrz().s[3]++,require('fastify'));const{Moctokit}=(cov_vwieuvxrz().s[4]++,require('@kie/mock-github'));function setEnvVar(key,value){cov_vwieuvxrz().f[0]++;cov_vwieuvxrz().s[5]++;process.env[key]=value;}function setInputParam(key,value){cov_vwieuvxrz().f[1]++;const envVarKey=(cov_vwieuvxrz().s[6]++,'INPUT_'+key.toUpperCase());cov_vwieuvxrz().s[7]++;setEnvVar(envVarKey,value);}function setupAction(t,options){cov_vwieuvxrz().f[2]++;cov_vwieuvxrz().s[8]++;setEnvVar('GITHUB_WORKSPACE',options.projectDir);cov_vwieuvxrz().s[9]++;setEnvVar('STEVE_SERVER_URL','http://localhost:3042');cov_vwieuvxrz().s[10]++;setEnvVar('HARRY_SERVER_URL','http://localhost:3043');cov_vwieuvxrz().s[11]++;setInputParam('platformatic_api_key','1234');cov_vwieuvxrz().s[12]++;setInputParam('github_token','test');}async function createRepository(t,projectDir){cov_vwieuvxrz().f[3]++;const actionEnvFolder=(cov_vwieuvxrz().s[13]++,await mkdtemp(join(tmpdir(),'action_env_')));const repositoryPath=(cov_vwieuvxrz().s[14]++,await mkdtemp(join(actionEnvFolder,'repository')));cov_vwieuvxrz().s[15]++;await cp(projectDir,repositoryPath,{recursive:true});cov_vwieuvxrz().s[16]++;t.teardown(async()=>{cov_vwieuvxrz().f[4]++;cov_vwieuvxrz().s[17]++;await rm(actionEnvFolder,{recursive:true});});const owner=(cov_vwieuvxrz().s[18]++,'octocat');const repositoryName=(cov_vwieuvxrz().s[19]++,'Hello-World');const prNumber=(cov_vwieuvxrz().s[20]++,1);const prTitle=(cov_vwieuvxrz().s[21]++,'test');const payload=(cov_vwieuvxrz().s[22]++,{pull_request:{number:prNumber,base:{repo:{owner:{login:owner},name:repositoryName}}},repository:{name:repositoryName,html_url:`https://github.com/${owner}/${repositoryName}`,owner:{login:owner}}});const githubEventConfigPath=(cov_vwieuvxrz().s[23]++,join(actionEnvFolder,'github_event.json'));cov_vwieuvxrz().s[24]++;await writeFile(githubEventConfigPath,JSON.stringify(payload));cov_vwieuvxrz().s[25]++;setEnvVar('GITHUB_EVENT_PATH',githubEventConfigPath);cov_vwieuvxrz().s[26]++;startGithubApi(t,owner,repositoryName,prNumber,prTitle);cov_vwieuvxrz().s[27]++;return repositoryPath;}function startGithubApi(t,owner,repositoryName,prNumber,prTitle){cov_vwieuvxrz().f[5]++;const moctokit=(cov_vwieuvxrz().s[28]++,new Moctokit());cov_vwieuvxrz().s[29]++;moctokit.rest.issues.createComment({owner,repo:repositoryName,issue_number:prNumber}).reply({status:200,data:{}});cov_vwieuvxrz().s[30]++;moctokit.rest.issues.listComments({owner,repo:repositoryName,issue_number:prNumber}).reply({status:200,data:[]});cov_vwieuvxrz().s[31]++;moctokit.rest.pulls.get({owner,repo:repositoryName,pull_number:prNumber}).reply({status:200,data:{head:{sha:'1234',ref:'test',repo:{full_name:`${owner}/${repositoryName}`,html_url:`https://github.com/${owner}/${repositoryName}`},user:{login:owner}},title:prTitle,number:prNumber,additions:1,deletions:1}});}async function startControlPanel(t){cov_vwieuvxrz().f[6]++;const controlPanel=(cov_vwieuvxrz().s[32]++,fastify({keepAliveTimeout:1}));cov_vwieuvxrz().s[33]++;controlPanel.post('/bundles',async(request,reply)=>{cov_vwieuvxrz().f[7]++;cov_vwieuvxrz().s[34]++;return{bundleId:'bundleId_1234',uploadToken:'uploadToken_1234'};});cov_vwieuvxrz().s[35]++;controlPanel.post('/bundles/:bundleId/deployment',async(request,reply)=>{cov_vwieuvxrz().f[8]++;cov_vwieuvxrz().s[36]++;return{url:'http://localhost:3044'};});cov_vwieuvxrz().s[37]++;t.teardown(async()=>{cov_vwieuvxrz().f[9]++;cov_vwieuvxrz().s[38]++;await controlPanel.close();});cov_vwieuvxrz().s[39]++;await controlPanel.listen({port:3042});cov_vwieuvxrz().s[40]++;return controlPanel;}async function startHarry(t){cov_vwieuvxrz().f[10]++;const harry=(cov_vwieuvxrz().s[41]++,fastify({keepAliveTimeout:1}));cov_vwieuvxrz().s[42]++;harry.addContentTypeParser('application/x-tar',{bodyLimit:1024*1024*1024},(request,payload,done)=>{cov_vwieuvxrz().f[11]++;cov_vwieuvxrz().s[43]++;return done();});cov_vwieuvxrz().s[44]++;harry.put('/upload',async(request,reply)=>{cov_vwieuvxrz().f[12]++;});cov_vwieuvxrz().s[45]++;t.teardown(async()=>{cov_vwieuvxrz().f[13]++;cov_vwieuvxrz().s[46]++;await harry.close();});cov_vwieuvxrz().s[47]++;await harry.listen({port:3043});cov_vwieuvxrz().s[48]++;return harry;}async function startMachine(t){cov_vwieuvxrz().f[14]++;const machine=(cov_vwieuvxrz().s[49]++,fastify({keepAliveTimeout:1}));cov_vwieuvxrz().s[50]++;machine.get('/',async(request,reply)=>{cov_vwieuvxrz().f[15]++;});cov_vwieuvxrz().s[51]++;t.teardown(async()=>{cov_vwieuvxrz().f[16]++;cov_vwieuvxrz().s[52]++;await machine.close();});cov_vwieuvxrz().s[53]++;await machine.listen({port:3044});cov_vwieuvxrz().s[54]++;return machine;}cov_vwieuvxrz().s[55]++;module.exports={setupAction,createRepository,startControlPanel,startHarry,startMachine,startGithubApi};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ0bXBkaXIiLCJyZXF1aXJlIiwiam9pbiIsIndyaXRlRmlsZSIsIm1rZHRlbXAiLCJjcCIsInJtIiwiZmFzdGlmeSIsIk1vY3Rva2l0Iiwic2V0RW52VmFyIiwia2V5IiwidmFsdWUiLCJwcm9jZXNzIiwiZW52Iiwic2V0SW5wdXRQYXJhbSIsImVudlZhcktleSIsInRvVXBwZXJDYXNlIiwic2V0dXBBY3Rpb24iLCJ0Iiwib3B0aW9ucyIsInByb2plY3REaXIiLCJjcmVhdGVSZXBvc2l0b3J5IiwiYWN0aW9uRW52Rm9sZGVyIiwicmVwb3NpdG9yeVBhdGgiLCJyZWN1cnNpdmUiLCJ0ZWFyZG93biIsIm93bmVyIiwicmVwb3NpdG9yeU5hbWUiLCJwck51bWJlciIsInByVGl0bGUiLCJwYXlsb2FkIiwicHVsbF9yZXF1ZXN0IiwibnVtYmVyIiwiYmFzZSIsInJlcG8iLCJsb2dpbiIsIm5hbWUiLCJyZXBvc2l0b3J5IiwiaHRtbF91cmwiLCJnaXRodWJFdmVudENvbmZpZ1BhdGgiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RhcnRHaXRodWJBcGkiLCJtb2N0b2tpdCIsInJlc3QiLCJpc3N1ZXMiLCJjcmVhdGVDb21tZW50IiwiaXNzdWVfbnVtYmVyIiwicmVwbHkiLCJzdGF0dXMiLCJkYXRhIiwibGlzdENvbW1lbnRzIiwicHVsbHMiLCJnZXQiLCJwdWxsX251bWJlciIsImhlYWQiLCJzaGEiLCJyZWYiLCJmdWxsX25hbWUiLCJ1c2VyIiwidGl0bGUiLCJhZGRpdGlvbnMiLCJkZWxldGlvbnMiLCJzdGFydENvbnRyb2xQYW5lbCIsImNvbnRyb2xQYW5lbCIsImtlZXBBbGl2ZVRpbWVvdXQiLCJwb3N0IiwicmVxdWVzdCIsImJ1bmRsZUlkIiwidXBsb2FkVG9rZW4iLCJ1cmwiLCJjbG9zZSIsImxpc3RlbiIsInBvcnQiLCJzdGFydEhhcnJ5IiwiaGFycnkiLCJhZGRDb250ZW50VHlwZVBhcnNlciIsImJvZHlMaW1pdCIsImRvbmUiLCJwdXQiLCJzdGFydE1hY2hpbmUiLCJtYWNoaW5lIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImhlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcblxuY29uc3QgeyB0bXBkaXIgfSA9IHJlcXVpcmUoJ29zJylcbmNvbnN0IHsgam9pbiB9ID0gcmVxdWlyZSgncGF0aCcpXG5jb25zdCB7IHdyaXRlRmlsZSwgbWtkdGVtcCwgY3AsIHJtIH0gPSByZXF1aXJlKCdmcy9wcm9taXNlcycpXG5cbmNvbnN0IGZhc3RpZnkgPSByZXF1aXJlKCdmYXN0aWZ5JylcbmNvbnN0IHsgTW9jdG9raXQgfSA9IHJlcXVpcmUoJ0BraWUvbW9jay1naXRodWInKVxuXG5mdW5jdGlvbiBzZXRFbnZWYXIgKGtleSwgdmFsdWUpIHtcbiAgcHJvY2Vzcy5lbnZba2V5XSA9IHZhbHVlXG59XG5cbmZ1bmN0aW9uIHNldElucHV0UGFyYW0gKGtleSwgdmFsdWUpIHtcbiAgY29uc3QgZW52VmFyS2V5ID0gJ0lOUFVUXycgKyBrZXkudG9VcHBlckNhc2UoKVxuICBzZXRFbnZWYXIoZW52VmFyS2V5LCB2YWx1ZSlcbn1cblxuZnVuY3Rpb24gc2V0dXBBY3Rpb24gKHQsIG9wdGlvbnMpIHtcbiAgc2V0RW52VmFyKCdHSVRIVUJfV09SS1NQQUNFJywgb3B0aW9ucy5wcm9qZWN0RGlyKVxuXG4gIHNldEVudlZhcignU1RFVkVfU0VSVkVSX1VSTCcsICdodHRwOi8vbG9jYWxob3N0OjMwNDInKVxuICBzZXRFbnZWYXIoJ0hBUlJZX1NFUlZFUl9VUkwnLCAnaHR0cDovL2xvY2FsaG9zdDozMDQzJylcblxuICBzZXRJbnB1dFBhcmFtKCdwbGF0Zm9ybWF0aWNfYXBpX2tleScsICcxMjM0JylcbiAgc2V0SW5wdXRQYXJhbSgnZ2l0aHViX3Rva2VuJywgJ3Rlc3QnKVxufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVSZXBvc2l0b3J5ICh0LCBwcm9qZWN0RGlyKSB7XG4gIGNvbnN0IGFjdGlvbkVudkZvbGRlciA9IGF3YWl0IG1rZHRlbXAoam9pbih0bXBkaXIoKSwgJ2FjdGlvbl9lbnZfJykpXG4gIGNvbnN0IHJlcG9zaXRvcnlQYXRoID0gYXdhaXQgbWtkdGVtcChqb2luKGFjdGlvbkVudkZvbGRlciwgJ3JlcG9zaXRvcnknKSlcbiAgYXdhaXQgY3AocHJvamVjdERpciwgcmVwb3NpdG9yeVBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pXG5cbiAgdC50ZWFyZG93bihhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgcm0oYWN0aW9uRW52Rm9sZGVyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KVxuICB9KVxuXG4gIGNvbnN0IG93bmVyID0gJ29jdG9jYXQnXG4gIGNvbnN0IHJlcG9zaXRvcnlOYW1lID0gJ0hlbGxvLVdvcmxkJ1xuXG4gIGNvbnN0IHByTnVtYmVyID0gMVxuICBjb25zdCBwclRpdGxlID0gJ3Rlc3QnXG5cbiAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICBwdWxsX3JlcXVlc3Q6IHtcbiAgICAgIG51bWJlcjogcHJOdW1iZXIsXG4gICAgICBiYXNlOiB7XG4gICAgICAgIHJlcG86IHtcbiAgICAgICAgICBvd25lcjoge1xuICAgICAgICAgICAgbG9naW46IG93bmVyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBuYW1lOiByZXBvc2l0b3J5TmFtZVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICByZXBvc2l0b3J5OiB7XG4gICAgICBuYW1lOiByZXBvc2l0b3J5TmFtZSxcbiAgICAgIGh0bWxfdXJsOiBgaHR0cHM6Ly9naXRodWIuY29tLyR7b3duZXJ9LyR7cmVwb3NpdG9yeU5hbWV9YCxcbiAgICAgIG93bmVyOiB7XG4gICAgICAgIGxvZ2luOiBvd25lclxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGdpdGh1YkV2ZW50Q29uZmlnUGF0aCA9IGpvaW4oYWN0aW9uRW52Rm9sZGVyLCAnZ2l0aHViX2V2ZW50Lmpzb24nKVxuICBhd2FpdCB3cml0ZUZpbGUoZ2l0aHViRXZlbnRDb25maWdQYXRoLCBKU09OLnN0cmluZ2lmeShwYXlsb2FkKSlcbiAgc2V0RW52VmFyKCdHSVRIVUJfRVZFTlRfUEFUSCcsIGdpdGh1YkV2ZW50Q29uZmlnUGF0aClcblxuICBzdGFydEdpdGh1YkFwaSh0LCBvd25lciwgcmVwb3NpdG9yeU5hbWUsIHByTnVtYmVyLCBwclRpdGxlKVxuXG4gIHJldHVybiByZXBvc2l0b3J5UGF0aFxufVxuXG5mdW5jdGlvbiBzdGFydEdpdGh1YkFwaSAodCwgb3duZXIsIHJlcG9zaXRvcnlOYW1lLCBwck51bWJlciwgcHJUaXRsZSkge1xuICBjb25zdCBtb2N0b2tpdCA9IG5ldyBNb2N0b2tpdCgpXG5cbiAgbW9jdG9raXQucmVzdC5pc3N1ZXMuY3JlYXRlQ29tbWVudCh7XG4gICAgb3duZXIsXG4gICAgcmVwbzogcmVwb3NpdG9yeU5hbWUsXG4gICAgaXNzdWVfbnVtYmVyOiBwck51bWJlclxuICB9KS5yZXBseSh7IHN0YXR1czogMjAwLCBkYXRhOiB7fSB9KVxuXG4gIG1vY3Rva2l0LnJlc3QuaXNzdWVzLmxpc3RDb21tZW50cyh7XG4gICAgb3duZXIsXG4gICAgcmVwbzogcmVwb3NpdG9yeU5hbWUsXG4gICAgaXNzdWVfbnVtYmVyOiBwck51bWJlclxuICB9KS5yZXBseSh7IHN0YXR1czogMjAwLCBkYXRhOiBbXSB9KVxuXG4gIG1vY3Rva2l0LnJlc3QucHVsbHMuZ2V0KHtcbiAgICBvd25lcixcbiAgICByZXBvOiByZXBvc2l0b3J5TmFtZSxcbiAgICBwdWxsX251bWJlcjogcHJOdW1iZXJcbiAgfSkucmVwbHkoe1xuICAgIHN0YXR1czogMjAwLFxuICAgIGRhdGE6IHtcbiAgICAgIGhlYWQ6IHtcbiAgICAgICAgc2hhOiAnMTIzNCcsXG4gICAgICAgIHJlZjogJ3Rlc3QnLFxuICAgICAgICByZXBvOiB7XG4gICAgICAgICAgZnVsbF9uYW1lOiBgJHtvd25lcn0vJHtyZXBvc2l0b3J5TmFtZX1gLFxuICAgICAgICAgIGh0bWxfdXJsOiBgaHR0cHM6Ly9naXRodWIuY29tLyR7b3duZXJ9LyR7cmVwb3NpdG9yeU5hbWV9YFxuICAgICAgICB9LFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgbG9naW46IG93bmVyXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB0aXRsZTogcHJUaXRsZSxcbiAgICAgIG51bWJlcjogcHJOdW1iZXIsXG4gICAgICBhZGRpdGlvbnM6IDEsXG4gICAgICBkZWxldGlvbnM6IDFcbiAgICB9XG4gIH0pXG59XG5cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0Q29udHJvbFBhbmVsICh0KSB7XG4gIGNvbnN0IGNvbnRyb2xQYW5lbCA9IGZhc3RpZnkoeyBrZWVwQWxpdmVUaW1lb3V0OiAxIH0pXG5cbiAgY29udHJvbFBhbmVsLnBvc3QoJy9idW5kbGVzJywgYXN5bmMgKHJlcXVlc3QsIHJlcGx5KSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGJ1bmRsZUlkOiAnYnVuZGxlSWRfMTIzNCcsXG4gICAgICB1cGxvYWRUb2tlbjogJ3VwbG9hZFRva2VuXzEyMzQnXG4gICAgfVxuICB9KVxuXG4gIGNvbnRyb2xQYW5lbC5wb3N0KCcvYnVuZGxlcy86YnVuZGxlSWQvZGVwbG95bWVudCcsIGFzeW5jIChyZXF1ZXN0LCByZXBseSkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwNDQnXG4gICAgfVxuICB9KVxuXG4gIHQudGVhcmRvd24oYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGNvbnRyb2xQYW5lbC5jbG9zZSgpXG4gIH0pXG4gIGF3YWl0IGNvbnRyb2xQYW5lbC5saXN0ZW4oeyBwb3J0OiAzMDQyIH0pXG4gIHJldHVybiBjb250cm9sUGFuZWxcbn1cblxuYXN5bmMgZnVuY3Rpb24gc3RhcnRIYXJyeSAodCkge1xuICBjb25zdCBoYXJyeSA9IGZhc3RpZnkoeyBrZWVwQWxpdmVUaW1lb3V0OiAxIH0pXG5cbiAgaGFycnkuYWRkQ29udGVudFR5cGVQYXJzZXIoXG4gICAgJ2FwcGxpY2F0aW9uL3gtdGFyJyxcbiAgICB7IGJvZHlMaW1pdDogMTAyNCAqIDEwMjQgKiAxMDI0IH0sXG4gICAgKHJlcXVlc3QsIHBheWxvYWQsIGRvbmUpID0+IGRvbmUoKVxuICApXG5cbiAgaGFycnkucHV0KCcvdXBsb2FkJywgYXN5bmMgKHJlcXVlc3QsIHJlcGx5KSA9PiB7fSlcblxuICB0LnRlYXJkb3duKGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBoYXJyeS5jbG9zZSgpXG4gIH0pXG4gIGF3YWl0IGhhcnJ5Lmxpc3Rlbih7IHBvcnQ6IDMwNDMgfSlcbiAgcmV0dXJuIGhhcnJ5XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0TWFjaGluZSAodCkge1xuICBjb25zdCBtYWNoaW5lID0gZmFzdGlmeSh7IGtlZXBBbGl2ZVRpbWVvdXQ6IDEgfSlcblxuICBtYWNoaW5lLmdldCgnLycsIGFzeW5jIChyZXF1ZXN0LCByZXBseSkgPT4ge30pXG5cbiAgdC50ZWFyZG93bihhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgbWFjaGluZS5jbG9zZSgpXG4gIH0pXG4gIGF3YWl0IG1hY2hpbmUubGlzdGVuKHsgcG9ydDogMzA0NCB9KVxuICByZXR1cm4gbWFjaGluZVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgc2V0dXBBY3Rpb24sXG4gIGNyZWF0ZVJlcG9zaXRvcnksXG4gIHN0YXJ0Q29udHJvbFBhbmVsLFxuICBzdGFydEhhcnJ5LFxuICBzdGFydE1hY2hpbmUsXG4gIHN0YXJ0R2l0aHViQXBpXG59XG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVkscXNOQWVBO0FBQUEseUZBYlosS0FBTSxDQUFFQSxNQUFPLENBQUMseUJBQUdDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFDaEMsS0FBTSxDQUFFQyxJQUFLLENBQUMseUJBQUdELE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFDaEMsS0FBTSxDQUFFRSxTQUFTLENBQUVDLE9BQU8sQ0FBRUMsRUFBRSxDQUFFQyxFQUFHLENBQUMseUJBQUdMLE9BQU8sQ0FBQyxhQUFhLENBQUMsRUFFN0QsS0FBTU0sUUFBTyx5QkFBR04sT0FB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