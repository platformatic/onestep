'use strict';function cov_16rfy9yh9p(){var path="/Users/ivan-tymoshenko/projects/platformatic/onestep/tests/executeAction.js";var hash="d9ef8571829735921cdfd8ad88c7cbb6345a80cb";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/ivan-tymoshenko/projects/platformatic/onestep/tests/executeAction.js",statementMap:{"0":{start:{line:3,column:19},end:{line:3,column:32}},"1":{start:{line:4,column:17},end:{line:4,column:32}},"2":{start:{line:5,column:28},end:{line:5,column:50}},"3":{start:{line:12,column:4},end:{line:12,column:26}},"4":{start:{line:15,column:26},end:{line:15,column:53}},"5":{start:{line:16,column:26},end:{line:16,column:52}},"6":{start:{line:17,column:33},end:{line:17,column:48}},"7":{start:{line:19,column:2},end:{line:21,column:3}},"8":{start:{line:20,column:4},end:{line:20,column:69}},"9":{start:{line:23,column:21},end:{line:23,column:25}},"10":{start:{line:25,column:2},end:{line:35,column:3}},"11":{start:{line:26,column:23},end:{line:26,column:67}},"12":{start:{line:27,column:4},end:{line:27,column:63}},"13":{start:{line:28,column:27},end:{line:28,column:74}},"14":{start:{line:29,column:4},end:{line:29,column:61}},"15":{start:{line:31,column:4},end:{line:31,column:40}},"16":{start:{line:32,column:4},end:{line:32,column:47}},"17":{start:{line:34,column:4},end:{line:34,column:49}},"18":{start:{line:37,column:2},end:{line:44,column:3}},"19":{start:{line:38,column:26},end:{line:38,column:49}},"20":{start:{line:39,column:4},end:{line:39,column:25}},"21":{start:{line:41,column:4},end:{line:43,column:5}},"22":{start:{line:42,column:6},end:{line:42,column:49}},"23":{start:{line:47,column:0},end:{line:47,column:5}}},fnMap:{"0":{name:"run",decl:{start:{line:14,column:15},end:{line:14,column:18}},loc:{start:{line:14,column:22},end:{line:45,column:1}},line:14}},branchMap:{"0":{loc:{start:{line:16,column:26},end:{line:16,column:52}},type:"binary-expr",locations:[{start:{line:16,column:26},end:{line:16,column:41}},{start:{line:16,column:45},end:{line:16,column:52}}],line:16},"1":{loc:{start:{line:19,column:2},end:{line:21,column:3}},type:"if",locations:[{start:{line:19,column:2},end:{line:21,column:3}},{start:{line:19,column:2},end:{line:21,column:3}}],line:19},"2":{loc:{start:{line:25,column:2},end:{line:35,column:3}},type:"if",locations:[{start:{line:25,column:2},end:{line:35,column:3}},{start:{line:25,column:2},end:{line:35,column:3}}],line:25},"3":{loc:{start:{line:41,column:4},end:{line:43,column:5}},type:"if",locations:[{start:{line:41,column:4},end:{line:43,column:5}},{start:{line:41,column:4},end:{line:43,column:5}}],line:41}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"d9ef8571829735921cdfd8ad88c7cbb6345a80cb"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_16rfy9yh9p=function(){return actualCoverage;};}return actualCoverage;}cov_16rfy9yh9p();const{tmpdir}=(cov_16rfy9yh9p().s[0]++,require('os'));const{join}=(cov_16rfy9yh9p().s[1]++,require('path'));const{mkdtemp,cp,rm}=(cov_16rfy9yh9p().s[2]++,require('fs/promises'));const{createRepository,setupAction,setEnvVariable,setInputParam}=(cov_16rfy9yh9p().s[3]++,require('./helper.js'));async function run(){cov_16rfy9yh9p().f[0]++;const setupRepository=(cov_16rfy9yh9p().s[4]++,process.argv[2]!=='false');const testProjectName=(cov_16rfy9yh9p().s[5]++,(cov_16rfy9yh9p().b[0][0]++,process.argv[3])||(cov_16rfy9yh9p().b[0][1]++,'basic'));const platformaticConfigPath=(cov_16rfy9yh9p().s[6]++,process.argv[4]);cov_16rfy9yh9p().s[7]++;if(platformaticConfigPath!==undefined){cov_16rfy9yh9p().b[1][0]++;cov_16rfy9yh9p().s[8]++;setInputParam('platformatic_config_path',platformaticConfigPath);}else{cov_16rfy9yh9p().b[1][1]++;}let actionFolder=(cov_16rfy9yh9p().s[9]++,null);cov_16rfy9yh9p().s[10]++;if(setupRepository){cov_16rfy9yh9p().b[2][0]++;const fixtureDir=(cov_16rfy9yh9p().s[11]++,join(__dirname,'fixtures',testProjectName));cov_16rfy9yh9p().s[12]++;actionFolder=await mkdtemp(join(tmpdir(),'action_env_'));const repositoryPath=(cov_16rfy9yh9p().s[13]++,await mkdtemp(join(actionFolder,'repository')));cov_16rfy9yh9p().s[14]++;await cp(fixtureDir,repositoryPath,{recursive:true});cov_16rfy9yh9p().s[15]++;await createRepository(actionFolder);cov_16rfy9yh9p().s[16]++;setupAction({projectDir:repositoryPath});cov_16rfy9yh9p().s[17]++;setEnvVariable('PLT_ENV_VARIABLE3','value3');}else{cov_16rfy9yh9p().b[2][1]++;}cov_16rfy9yh9p().s[18]++;try{const executeAction=(cov_16rfy9yh9p().s[19]++,require('../action.js'));cov_16rfy9yh9p().s[20]++;await executeAction();}finally{cov_16rfy9yh9p().s[21]++;if(actionFolder!==null){cov_16rfy9yh9p().b[3][0]++;cov_16rfy9yh9p().s[22]++;await rm(actionFolder,{recursive:true});}else{cov_16rfy9yh9p().b[3][1]++;}}}cov_16rfy9yh9p().s[23]++;run();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ0bXBkaXIiLCJyZXF1aXJlIiwiam9pbiIsIm1rZHRlbXAiLCJjcCIsInJtIiwiY3JlYXRlUmVwb3NpdG9yeSIsInNldHVwQWN0aW9uIiwic2V0RW52VmFyaWFibGUiLCJzZXRJbnB1dFBhcmFtIiwicnVuIiwic2V0dXBSZXBvc2l0b3J5IiwicHJvY2VzcyIsImFyZ3YiLCJ0ZXN0UHJvamVjdE5hbWUiLCJwbGF0Zm9ybWF0aWNDb25maWdQYXRoIiwidW5kZWZpbmVkIiwiYWN0aW9uRm9sZGVyIiwiZml4dHVyZURpciIsIl9fZGlybmFtZSIsInJlcG9zaXRvcnlQYXRoIiwicmVjdXJzaXZlIiwicHJvamVjdERpciIsImV4ZWN1dGVBY3Rpb24iXSwic291cmNlcyI6WyJleGVjdXRlQWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5jb25zdCB7IHRtcGRpciB9ID0gcmVxdWlyZSgnb3MnKVxuY29uc3QgeyBqb2luIH0gPSByZXF1aXJlKCdwYXRoJylcbmNvbnN0IHsgbWtkdGVtcCwgY3AsIHJtIH0gPSByZXF1aXJlKCdmcy9wcm9taXNlcycpXG5cbmNvbnN0IHtcbiAgY3JlYXRlUmVwb3NpdG9yeSxcbiAgc2V0dXBBY3Rpb24sXG4gIHNldEVudlZhcmlhYmxlLFxuICBzZXRJbnB1dFBhcmFtXG59ID0gcmVxdWlyZSgnLi9oZWxwZXIuanMnKVxuXG5hc3luYyBmdW5jdGlvbiBydW4gKCkge1xuICBjb25zdCBzZXR1cFJlcG9zaXRvcnkgPSBwcm9jZXNzLmFyZ3ZbMl0gIT09ICdmYWxzZSdcbiAgY29uc3QgdGVzdFByb2plY3ROYW1lID0gcHJvY2Vzcy5hcmd2WzNdIHx8ICdiYXNpYydcbiAgY29uc3QgcGxhdGZvcm1hdGljQ29uZmlnUGF0aCA9IHByb2Nlc3MuYXJndls0XVxuXG4gIGlmIChwbGF0Zm9ybWF0aWNDb25maWdQYXRoICE9PSB1bmRlZmluZWQpIHtcbiAgICBzZXRJbnB1dFBhcmFtKCdwbGF0Zm9ybWF0aWNfY29uZmlnX3BhdGgnLCBwbGF0Zm9ybWF0aWNDb25maWdQYXRoKVxuICB9XG5cbiAgbGV0IGFjdGlvbkZvbGRlciA9IG51bGxcblxuICBpZiAoc2V0dXBSZXBvc2l0b3J5KSB7XG4gICAgY29uc3QgZml4dHVyZURpciA9IGpvaW4oX19kaXJuYW1lLCAnZml4dHVyZXMnLCB0ZXN0UHJvamVjdE5hbWUpXG4gICAgYWN0aW9uRm9sZGVyID0gYXdhaXQgbWtkdGVtcChqb2luKHRtcGRpcigpLCAnYWN0aW9uX2Vudl8nKSlcbiAgICBjb25zdCByZXBvc2l0b3J5UGF0aCA9IGF3YWl0IG1rZHRlbXAoam9pbihhY3Rpb25Gb2xkZXIsICdyZXBvc2l0b3J5JykpXG4gICAgYXdhaXQgY3AoZml4dHVyZURpciwgcmVwb3NpdG9yeVBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pXG5cbiAgICBhd2FpdCBjcmVhdGVSZXBvc2l0b3J5KGFjdGlvbkZvbGRlcilcbiAgICBzZXR1cEFjdGlvbih7IHByb2plY3REaXI6IHJlcG9zaXRvcnlQYXRoIH0pXG5cbiAgICBzZXRFbnZWYXJpYWJsZSgnUExUX0VOVl9WQVJJQUJMRTMnLCAndmFsdWUzJylcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgZXhlY3V0ZUFjdGlvbiA9IHJlcXVpcmUoJy4uL2FjdGlvbi5qcycpXG4gICAgYXdhaXQgZXhlY3V0ZUFjdGlvbigpXG4gIH0gZmluYWxseSB7XG4gICAgaWYgKGFjdGlvbkZvbGRlciAhPT0gbnVsbCkge1xuICAgICAgYXdhaXQgcm0oYWN0aW9uRm9sZGVyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KVxuICAgIH1cbiAgfVxufVxuXG5ydW4oKVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZLGtoR0FlQTtBQUFBLDJGQWJaLEtBQU0sQ0FBRUEsTUFBTyxDQUFDLDBCQUFHQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQ2hDLEtBQU0sQ0FBRUMsSUFBSyxDQUFDLDBCQUFHRCxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQ2hDLEtBQU0sQ0FBRUUsT0FBTyxDQUFFQyxFQUFFLENBQUVDLEVBQUcsQ0FBQywwQkFBR0osT0FBTyxDQUFDLGFBQWEsQ0FBQyxFQUVsRCxLQUFNLENBQ0pLLGdCQUFnQixDQUNoQkMsV0FBVyxDQUNYQyxjQUFjLENBQ2RDLGFBQ0YsQ0FBQywwQkFBR1IsT0FBTyxDQUFDLGFBQWEsQ0FBQyxFQUUxQixjQUFlUyxJQUFHLEVBQUkseUJBQ3BCLEtBQU1DLGdCQUFlLDBCQUFHQyxPQUFPLENBQUNDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBSyxPQUFPLEVBQ25ELEtBQU1DLGdCQUFlLDBCQUFHLDRCQUFBRixPQUFPLENBQUNDLElBQUksQ0FBQyxDQUFDLENBQUMsK0JBQUksT0FBTyxHQUNsRCxLQUFNRSx1QkFBc0IsMEJBQUdILE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQywwQkFFOUMsR0FBSUUsc0JBQXNCLEdBQUtDLFNBQVMsQ0FBRSxvREFDeENQLGFBQWEsQ0FBQywwQkFBMEIsQ0FBRU0sc0JBQXNCLENBQUMsQ0FDbkUsQ0FBQyxpQ0FFRCxHQUFJRSxhQUFZLDBCQUFHLElBQUksMkJBRXZCLEdBQUlOLGVBQWUsQ0FBRSw0QkFDbkIsS0FBTU8sV0FBVSwyQkFBR2hCLElBQUksQ0FBQ2lCLFNBQVMsQ0FBRSxVQUFVLENBQUVMLGVBQWUsQ0FBQywyQkFDL0RHLFlBQVksQ0FBRyxLQUFNZCxRQUFPLENBQUNELElBQUksQ0FBQ0YsTUFBTSxFQUFFLENBQUUsYUFBYSxDQUFDLENBQUMsQ0FDM0QsS0FBTW9CLGVBQWMsMkJBQUcsS0FBTWpCLFFBQU8sQ0FBQ0QsSUFBSSxDQUFDZSxZQUFZLENBQUUsWUFBWSxDQUFDLENBQUMsMkJBQ3RFLEtBQU1iLEdBQUUsQ0FBQ2MsVUFBVSxDQUFFRSxjQUFjLENBQUUsQ0FBRUMsU0FBUyxDQUFFLElBQUssQ0FBQyxDQUFDLDBCQUV6RCxLQUFNZixpQkFBZ0IsQ0FBQ1csWUFBWSxDQUFDLDBCQUNwQ1YsV0FBVyxDQUFDLENBQUVlLFVBQVUsQ0FBRUYsY0FBZSxDQUFDLENBQUMsMEJBRTNDWixjQUFjLENBQUMsbUJBQW1CLENBQUUsUUFBUSxDQUFDLENBQy9DLENBQUMsMERBRUQsR0FBSSxDQUNGLEtBQU1lLGNBQWEsMkJBQUd0QixPQUFPLENBQUMsY0FBYyxDQUFDLDJCQUM3QyxLQUFNc0IsY0FBYSxFQUFFLENBQ3ZCLENBQUMsT0FBUywwQkFDUixHQUFJTixZQUFZLEdBQUssSUFBSSxDQUFFLHFEQUN6QixLQUFNWixHQUFFLENBQUNZLFlBQVksQ0FBRSxDQUFFSSxTQUFTLENBQUUsSUFBSyxDQUFDLENBQUMsQ0FDN0MsQ0FBQyxpQ0FDSCxDQUNGLENBQUMseUJBRURYLEdBQUcsRUFBRSJ9