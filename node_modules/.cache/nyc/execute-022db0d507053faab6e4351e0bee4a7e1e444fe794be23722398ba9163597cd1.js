'use strict';function cov_m3vzi29jy(){var path="/Users/ivan-tymoshenko/projects/platformatic/onestep/tests/execute.js";var hash="b5d7a817bba0e2e27d681da8e438ec2b7ac6993b";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/ivan-tymoshenko/projects/platformatic/onestep/tests/execute.js",statementMap:{"0":{start:{line:3,column:19},end:{line:3,column:32}},"1":{start:{line:4,column:17},end:{line:4,column:32}},"2":{start:{line:5,column:28},end:{line:5,column:50}},"3":{start:{line:11,column:4},end:{line:11,column:26}},"4":{start:{line:13,column:23},end:{line:21,column:1}},"5":{start:{line:24,column:26},end:{line:24,column:53}},"6":{start:{line:25,column:26},end:{line:25,column:52}},"7":{start:{line:32,column:21},end:{line:32,column:25}},"8":{start:{line:34,column:2},end:{line:44,column:3}},"9":{start:{line:35,column:23},end:{line:35,column:67}},"10":{start:{line:36,column:4},end:{line:36,column:63}},"11":{start:{line:37,column:27},end:{line:37,column:74}},"12":{start:{line:38,column:4},end:{line:38,column:61}},"13":{start:{line:40,column:4},end:{line:40,column:40}},"14":{start:{line:41,column:4},end:{line:41,column:102}},"15":{start:{line:43,column:4},end:{line:43,column:49}},"16":{start:{line:46,column:2},end:{line:53,column:3}},"17":{start:{line:47,column:26},end:{line:47,column:49}},"18":{start:{line:48,column:4},end:{line:48,column:25}},"19":{start:{line:50,column:4},end:{line:52,column:5}},"20":{start:{line:51,column:6},end:{line:51,column:49}},"21":{start:{line:56,column:0},end:{line:56,column:5}}},fnMap:{"0":{name:"run",decl:{start:{line:23,column:15},end:{line:23,column:18}},loc:{start:{line:23,column:22},end:{line:54,column:1}},line:23}},branchMap:{"0":{loc:{start:{line:25,column:26},end:{line:25,column:52}},type:"binary-expr",locations:[{start:{line:25,column:26},end:{line:25,column:41}},{start:{line:25,column:45},end:{line:25,column:52}}],line:25},"1":{loc:{start:{line:34,column:2},end:{line:44,column:3}},type:"if",locations:[{start:{line:34,column:2},end:{line:44,column:3}},{start:{line:34,column:2},end:{line:44,column:3}}],line:34},"2":{loc:{start:{line:50,column:4},end:{line:52,column:5}},type:"if",locations:[{start:{line:50,column:4},end:{line:52,column:5}},{start:{line:50,column:4},end:{line:52,column:5}}],line:50}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"b5d7a817bba0e2e27d681da8e438ec2b7ac6993b"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_m3vzi29jy=function(){return actualCoverage;};}return actualCoverage;}cov_m3vzi29jy();const{tmpdir}=(cov_m3vzi29jy().s[0]++,require('os'));const{join}=(cov_m3vzi29jy().s[1]++,require('path'));const{mkdtemp,cp,rm}=(cov_m3vzi29jy().s[2]++,require('fs/promises'));const{createRepository,setEnvVariable,setInputParam}=(cov_m3vzi29jy().s[3]++,require('./helper.js'));const defaultEnvVars=(cov_m3vzi29jy().s[4]++,{GITHUB_WORKSPACE:'',STEVE_SERVER_URL:'http://localhost:3042',HARRY_SERVER_URL:'http://localhost:3043',INPUT_PLATFORMATIC_API_KEY:'1234',INPUT_GITHUB_TOKEN:'test'});async function run(){cov_m3vzi29jy().f[0]++;const setupRepository=(cov_m3vzi29jy().s[5]++,process.argv[2]!=='false');const testProjectName=(cov_m3vzi29jy().s[6]++,(cov_m3vzi29jy().b[0][0]++,process.argv[3])||(cov_m3vzi29jy().b[0][1]++,'basic'));// const platformaticConfigPath = process.argv[4]
// if (platformaticConfigPath !== undefined) {
//   setInputParam('platformatic_config_path', platformaticConfigPath)
// }
let actionFolder=(cov_m3vzi29jy().s[7]++,null);cov_m3vzi29jy().s[8]++;if(setupRepository){cov_m3vzi29jy().b[1][0]++;const fixtureDir=(cov_m3vzi29jy().s[9]++,join(__dirname,'fixtures',testProjectName));cov_m3vzi29jy().s[10]++;actionFolder=await mkdtemp(join(tmpdir(),'action_env_'));const repositoryPath=(cov_m3vzi29jy().s[11]++,await mkdtemp(join(actionFolder,'repository')));cov_m3vzi29jy().s[12]++;await cp(fixtureDir,repositoryPath,{recursive:true});cov_m3vzi29jy().s[13]++;await createRepository(actionFolder);cov_m3vzi29jy().s[14]++;process.env=Object.assign({},defaultEnvVars,process.env,{GITHUB_WORKSPACE:repositoryPath});cov_m3vzi29jy().s[15]++;setEnvVariable('PLT_ENV_VARIABLE3','value3');}else{cov_m3vzi29jy().b[1][1]++;}cov_m3vzi29jy().s[16]++;try{const executeAction=(cov_m3vzi29jy().s[17]++,require('../action.js'));cov_m3vzi29jy().s[18]++;await executeAction();}finally{cov_m3vzi29jy().s[19]++;if(actionFolder!==null){cov_m3vzi29jy().b[2][0]++;cov_m3vzi29jy().s[20]++;await rm(actionFolder,{recursive:true});}else{cov_m3vzi29jy().b[2][1]++;}}}cov_m3vzi29jy().s[21]++;run();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ0bXBkaXIiLCJyZXF1aXJlIiwiam9pbiIsIm1rZHRlbXAiLCJjcCIsInJtIiwiY3JlYXRlUmVwb3NpdG9yeSIsInNldEVudlZhcmlhYmxlIiwic2V0SW5wdXRQYXJhbSIsImRlZmF1bHRFbnZWYXJzIiwiR0lUSFVCX1dPUktTUEFDRSIsIlNURVZFX1NFUlZFUl9VUkwiLCJIQVJSWV9TRVJWRVJfVVJMIiwiSU5QVVRfUExBVEZPUk1BVElDX0FQSV9LRVkiLCJJTlBVVF9HSVRIVUJfVE9LRU4iLCJydW4iLCJzZXR1cFJlcG9zaXRvcnkiLCJwcm9jZXNzIiwiYXJndiIsInRlc3RQcm9qZWN0TmFtZSIsImFjdGlvbkZvbGRlciIsImZpeHR1cmVEaXIiLCJfX2Rpcm5hbWUiLCJyZXBvc2l0b3J5UGF0aCIsInJlY3Vyc2l2ZSIsImVudiIsIk9iamVjdCIsImFzc2lnbiIsImV4ZWN1dGVBY3Rpb24iXSwic291cmNlcyI6WyJleGVjdXRlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5jb25zdCB7IHRtcGRpciB9ID0gcmVxdWlyZSgnb3MnKVxuY29uc3QgeyBqb2luIH0gPSByZXF1aXJlKCdwYXRoJylcbmNvbnN0IHsgbWtkdGVtcCwgY3AsIHJtIH0gPSByZXF1aXJlKCdmcy9wcm9taXNlcycpXG5cbmNvbnN0IHtcbiAgY3JlYXRlUmVwb3NpdG9yeSxcbiAgc2V0RW52VmFyaWFibGUsXG4gIHNldElucHV0UGFyYW1cbn0gPSByZXF1aXJlKCcuL2hlbHBlci5qcycpXG5cbmNvbnN0IGRlZmF1bHRFbnZWYXJzID0ge1xuICBHSVRIVUJfV09SS1NQQUNFOiAnJyxcblxuICBTVEVWRV9TRVJWRVJfVVJMOiAnaHR0cDovL2xvY2FsaG9zdDozMDQyJyxcbiAgSEFSUllfU0VSVkVSX1VSTDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzA0MycsXG5cbiAgSU5QVVRfUExBVEZPUk1BVElDX0FQSV9LRVk6ICcxMjM0JyxcbiAgSU5QVVRfR0lUSFVCX1RPS0VOOiAndGVzdCdcbn1cblxuYXN5bmMgZnVuY3Rpb24gcnVuICgpIHtcbiAgY29uc3Qgc2V0dXBSZXBvc2l0b3J5ID0gcHJvY2Vzcy5hcmd2WzJdICE9PSAnZmFsc2UnXG4gIGNvbnN0IHRlc3RQcm9qZWN0TmFtZSA9IHByb2Nlc3MuYXJndlszXSB8fCAnYmFzaWMnXG4gIC8vIGNvbnN0IHBsYXRmb3JtYXRpY0NvbmZpZ1BhdGggPSBwcm9jZXNzLmFyZ3ZbNF1cblxuICAvLyBpZiAocGxhdGZvcm1hdGljQ29uZmlnUGF0aCAhPT0gdW5kZWZpbmVkKSB7XG4gIC8vICAgc2V0SW5wdXRQYXJhbSgncGxhdGZvcm1hdGljX2NvbmZpZ19wYXRoJywgcGxhdGZvcm1hdGljQ29uZmlnUGF0aClcbiAgLy8gfVxuXG4gIGxldCBhY3Rpb25Gb2xkZXIgPSBudWxsXG5cbiAgaWYgKHNldHVwUmVwb3NpdG9yeSkge1xuICAgIGNvbnN0IGZpeHR1cmVEaXIgPSBqb2luKF9fZGlybmFtZSwgJ2ZpeHR1cmVzJywgdGVzdFByb2plY3ROYW1lKVxuICAgIGFjdGlvbkZvbGRlciA9IGF3YWl0IG1rZHRlbXAoam9pbih0bXBkaXIoKSwgJ2FjdGlvbl9lbnZfJykpXG4gICAgY29uc3QgcmVwb3NpdG9yeVBhdGggPSBhd2FpdCBta2R0ZW1wKGpvaW4oYWN0aW9uRm9sZGVyLCAncmVwb3NpdG9yeScpKVxuICAgIGF3YWl0IGNwKGZpeHR1cmVEaXIsIHJlcG9zaXRvcnlQYXRoLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KVxuXG4gICAgYXdhaXQgY3JlYXRlUmVwb3NpdG9yeShhY3Rpb25Gb2xkZXIpXG4gICAgcHJvY2Vzcy5lbnYgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0RW52VmFycywgcHJvY2Vzcy5lbnYsIHsgR0lUSFVCX1dPUktTUEFDRTogcmVwb3NpdG9yeVBhdGggfSlcblxuICAgIHNldEVudlZhcmlhYmxlKCdQTFRfRU5WX1ZBUklBQkxFMycsICd2YWx1ZTMnKVxuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBleGVjdXRlQWN0aW9uID0gcmVxdWlyZSgnLi4vYWN0aW9uLmpzJylcbiAgICBhd2FpdCBleGVjdXRlQWN0aW9uKClcbiAgfSBmaW5hbGx5IHtcbiAgICBpZiAoYWN0aW9uRm9sZGVyICE9PSBudWxsKSB7XG4gICAgICBhd2FpdCBybShhY3Rpb25Gb2xkZXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pXG4gICAgfVxuICB9XG59XG5cbnJ1bigpXG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVksZ3NGQWVBO0FBQUEseUZBYlosS0FBTSxDQUFFQSxNQUFPLENBQUMseUJBQUdDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFDaEMsS0FBTSxDQUFFQyxJQUFLLENBQUMseUJBQUdELE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFDaEMsS0FBTSxDQUFFRSxPQUFPLENBQUVDLEVBQUUsQ0FBRUMsRUFBRyxDQUFDLHlCQUFHSixPQUFPLENBQUMsYUFBYSxDQUFDLEVBRWxELEtBQU0sQ0FDSkssZ0JBQWdCLENBQ2hCQyxjQUFjLENBQ2RDLGFBQ0YsQ0FBQyx5QkFBR1AsT0FBTyxDQUFDLGFBQWEsQ0FBQyxFQUUxQixLQUFNUSxlQUFjLHlCQUFHLENBQ3JCQyxnQkFBZ0IsQ0FBRSxFQUFFLENBRXBCQyxnQkFBZ0IsQ0FBRSx1QkFBdUIsQ0FDekNDLGdCQUFnQixDQUFFLHVCQUF1QixDQUV6Q0MsMEJBQTBCLENBQUUsTUFBTSxDQUNsQ0Msa0JBQWtCLENBQUUsTUFDdEIsQ0FBQyxFQUVELGNBQWVDLElBQUcsRUFBSSx3QkFDcEIsS0FBTUMsZ0JBQWUseUJBQUdDLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFLLE9BQU8sRUFDbkQsS0FBTUMsZ0JBQWUseUJBQUcsMkJBQUFGLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQyw4QkFBSSxPQUFPLEdBQ2xEO0FBRUE7QUFDQTtBQUNBO0FBRUEsR0FBSUUsYUFBWSx5QkFBRyxJQUFJLHlCQUV2QixHQUFJSixlQUFlLENBQUUsMkJBQ25CLEtBQU1LLFdBQVUseUJBQUduQixJQUFJLENBQUNvQixTQUFTLENBQUUsVUFBVSxDQUFFSCxlQUFlLENBQUMsMEJBQy9EQyxZQUFZLENBQUcsS0FBTWpCLFFBQU8sQ0FBQ0QsSUFBSSxDQUFDRixNQUFNLEVBQUUsQ0FBRSxhQUFhLENBQUMsQ0FBQyxDQUMzRCxLQUFNdUIsZUFBYywwQkFBRyxLQUFNcEIsUUFBTyxDQUFDRCxJQUFJLENBQUNrQixZQUFZLENBQUUsWUFBWSxDQUFDLENBQUMsMEJBQ3RFLEtBQU1oQixHQUFFLENBQUNpQixVQUFVLENBQUVFLGNBQWMsQ0FBRSxDQUFFQyxTQUFTLENBQUUsSUFBSyxDQUFDLENBQUMseUJBRXpELEtBQU1sQixpQkFBZ0IsQ0FBQ2MsWUFBWSxDQUFDLHlCQUNwQ0gsT0FBTyxDQUFDUSxHQUFHLENBQUdDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFFbEIsY0FBYyxDQUFFUSxPQUFPLENBQUNRLEdBQUcsQ0FBRSxDQUFFZixnQkFBZ0IsQ0FBRWEsY0FBZSxDQUFDLENBQUMseUJBRWxHaEIsY0FBYyxDQUFDLG1CQUFtQixDQUFFLFFBQVEsQ0FBQyxDQUMvQyxDQUFDLHdEQUVELEdBQUksQ0FDRixLQUFNcUIsY0FBYSwwQkFBRzNCLE9BQU8sQ0FBQyxjQUFjLENBQUMsMEJBQzdDLEtBQU0yQixjQUFhLEVBQUUsQ0FDdkIsQ0FBQyxPQUFTLHlCQUNSLEdBQUlSLFlBQVksR0FBSyxJQUFJLENBQUUsbURBQ3pCLEtBQU1mLEdBQUUsQ0FBQ2UsWUFBWSxDQUFFLENBQUVJLFNBQVMsQ0FBRSxJQUFLLENBQUMsQ0FBQyxDQUM3QyxDQUFDLGdDQUNILENBQ0YsQ0FBQyx3QkFFRFQsR0FBRyxFQUFFIn0=