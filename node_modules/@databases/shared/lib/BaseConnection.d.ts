import type { SQLQuery } from '@databases/sql';
import { Disposable, TransactionFactory } from './Factory';
import Driver from './Driver';
import QueryableType from './QueryableType';
import { Lock } from '@databases/lock';
declare type TransactionOptions<TDriver extends Driver<any, any>> = TDriver extends Driver<infer TTransactionOptions, any> ? TTransactionOptions : unknown;
declare type QueryStreamOptions<TDriver extends Driver<any, any>> = TDriver extends Driver<any, infer TQueryStreamOptions> ? TQueryStreamOptions : unknown;
export default class BaseConnection<TTransaction extends Disposable, TDriver extends Driver<any, any>> {
    readonly type = QueryableType.Connection;
    protected readonly _lock: Lock;
    private _disposed;
    protected _throwIfDisposed(): void;
    protected readonly _driver: TDriver;
    private readonly _factories;
    constructor(driver: TDriver, factories: TransactionFactory<TDriver, TTransaction>);
    task<T>(fn: (connection: this) => Promise<T>): Promise<T>;
    tx<TResult>(fn: (connection: TTransaction) => Promise<TResult>, options?: TransactionOptions<TDriver>): Promise<TResult>;
    query(query: SQLQuery): Promise<any[]>;
    query(query: SQLQuery[]): Promise<any[][]>;
    addPostCommitStep(fn: () => Promise<void>): Promise<void>;
    queryStream(query: SQLQuery, options?: QueryStreamOptions<TDriver>): AsyncGenerator<any, void, unknown>;
    dispose(): Promise<void>;
}
export {};
