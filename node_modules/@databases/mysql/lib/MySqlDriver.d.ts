/// <reference types="node" />
import { Readable } from 'stream';
import { SQLQuery } from '@databases/sql';
import { Driver } from '@databases/shared';
import { Connection as MySqlClient } from 'mysql2/promise';
import TransactionOptions from './types/TransactionOptions';
import EventHandlers from './types/EventHandlers';
import QueryStreamOptions from './types/QueryStreamOptions';
export default class MySqlDriver implements Driver<TransactionOptions, QueryStreamOptions> {
    readonly acquireLockTimeoutMilliseconds: number;
    readonly client: MySqlClient;
    private readonly _handlers;
    private _endCalled;
    constructor(client: MySqlClient, handlers: EventHandlers, acquireLockTimeoutMilliseconds: number);
    private _removeFromPool;
    private _idleErrorEventHandler;
    private readonly _onIdleError;
    onAddingToPool(removeFromPool: undefined | (() => void), idleErrorEventHandler: undefined | ((err: Error) => void)): void;
    onActive(): void;
    onIdle(): void;
    dispose(): Promise<void>;
    canRecycleConnectionAfterError(_err: Error): Promise<boolean>;
    beginTransaction(options?: TransactionOptions): Promise<void>;
    commitTransaction(): Promise<void>;
    rollbackTransaction(): Promise<void>;
    shouldRetryTransactionFailure(_transactionOptions: TransactionOptions | undefined, _ex: Error, _failureCount: number): Promise<boolean>;
    createSavepoint(savepointName: string): Promise<void>;
    releaseSavepoint(savepointName: string): Promise<void>;
    rollbackToSavepoint(savepointName: string): Promise<void>;
    private _executeQuery;
    executeAndReturnAll(queries: SQLQuery[]): Promise<any[][]>;
    executeAndReturnLast(queries: SQLQuery[]): Promise<any[]>;
    queryStream(query: SQLQuery, options?: QueryStreamOptions): AsyncGenerator<any, void, unknown>;
    queryNodeStream(query: SQLQuery, options?: QueryStreamOptions): Readable;
}
