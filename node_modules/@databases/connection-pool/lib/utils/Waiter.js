"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const timeout_1 = require("./timeout");
/**
 * A task in the queue that is waiting for a connection
 * to become available.
 */
class Waiter {
    constructor(resolve, timeoutMilliseconds) {
        this._resolve = resolve;
        if (timeoutMilliseconds !== Infinity) {
            this._timeout = setTimeout(
            // tslint:disable-next-line: no-unbound-method
            Waiter.waiterTimeout, timeoutMilliseconds, this);
        }
    }
    static waiterTimeout(waiter) {
        if (waiter._resolve) {
            waiter._resolve(timeout_1.timeout);
            waiter._resolve = null;
        }
    }
    isTimedOut() {
        return this._resolve === null;
    }
    resolve(connection) {
        clearTimeout(this._timeout);
        this._resolve(connection);
    }
}
exports.default = Waiter;
//# sourceMappingURL=Waiter.js.map